[{"title":"CuLH note","url":"/2025/01/17/CuLH-note/","content":"关于CuLH这个代码的一些注释。我整理了两个源代码分别是CuLH_box.cuf和CuLH_fireball.cuf，代表box计算和火球计算，分别都包含了完整的计算轻核的chanel。这两个代码的区别如下：\n! 计算的chanel不一样，fireball多了SCpiDt和599两个关于共振态的过程,并且只测试deuteronINTEGER, DIMENSION(NSPC) :: SPC = [SCpi,SCpiDt,SCdPC,599], SPCR, od    ! fireball -&gt;res d INTEGER, DIMENSION(NSPC) :: SPC = [SCpi,SCdPC,SCthPC,SCaPC], SPCR, od    ! box -&gt; d t he3 he4! 初始化函数不一样：CALL INIT_hydro(NTmx,dt,3.0,0)CALL INITNM_Bzm_free2 ! 周期性边界条件不一样，一个开一个关，BOX size不一样INTEGER, PARAMETER :: PBC = 0    ! 1 for periodic condiditonINTEGER, PARAMETER :: mxx = 10, mxz = 10, mxpx = 4, mxpz = 4\n\n\n\n怎么runfortran的cuda代码需要nvfortran编译器，组里服务器安装的有，不建议自己本地配置。首先登录到组里服务器，然后切换到gpu的节点：\nssh -Y gpufarm211## 输自己的密码，这个节点有五张GPU,nvidia-smi## 编译命令nvfortran CuLH.cuf ## 会出来一个a.out可执行文件## 运行echo 0 | ./a.out &gt;&gt; output &amp;## 上面这步是用编号为0的gpu来计算并将结果保存到output文件内，避免输出到屏幕。\n编译确保自己的当前目录里有后缀为cuf的源文件代码，运行确保当前目录有input文件SP-IN.dat。\nchanel首先定位到代码最后的主函数。代码的各种Chanel用数组来记录，比如SCpi，表示piN到delta的chanel，包含了10个chanel，具体的过程通过具体的元素可以搜索到。然后将要计算的chanel添加到SPC这个数组：\nINTEGER, DIMENSION(NSPC) :: SPC = [SCpi,SCdPC,SCthPC,SCaPC], SPCR, od    ! 这四个chanel分别是piN-&gt;delta,delta+N-&gt;pi+d, delta+NN-&gt;pi+t/he3,以及he4.\n最后在主函数开始的地方，修改NSPC这个参数，值等于所有chanel的数量之和，比如上面的box计算轻核的chanel，就是10+9+16+9&#x3D;44\nbox计算几个重要的函数：\nINTEGER, PARAMETER :: PBC = 0    !line:4425. 1 for periodic condiditonINTEGER, PARAMETER :: mxx = 10, mxz = 10, mxpx = 4, mxpz = 4 !line:4434. box sizeCALL INITNM_Bzm_free2 !line:28159  初始化box的函数，里面可以修改sample粒子的数目，这个数目是乘以test particle的数目，比如想初始化480个pi0，主函数里test particle是100，这个函数里pi0就是48000。CALL yld(-0.5) !line:28200 是否对最后的产额结果统计rapidity的cut，加个负号表示不作任何cut，0.5表示取快度在+-0.5之间。SUBROUTINE SPC4PClcl_d !line:18392. 这个函数的最后，在所有-68的case下可以给he4的prb乘以一个因子增大统计量。 SUBROUTINE SPC3PClcl_d !line:17847. 同理这个函数给triton/he3增大prb。\nfireball 计算fireball的计算为了不让delta跑出fireball外面，需要增大box的size。\nCALL INIT_hydro(NTmx,dt,3.0,0) !计算fireball的初始化程序。参数分别是总步长，dt，快度cut，是否读取轻核。NE = 8000; NTmx = 500; dnstp = 500; dt = 0.1 !这一行第一个参数是test particle数目，第二个是步数，第三个决定多少步输出一次相空间数据，第四个dt。\noutput主要看CuLH_yld.dat这个文件，分别是dt,p,n,delta++,delta+,delta0,delta-,pi+,pi0,pi-,d,he3,t,he4,he41st, he42st, he43strp0000.dat是初态分布，rp0500.dat是末态分布。 \n","tags":["cuda"]},{"title":"QFT","url":"/2021/10/09/QFT/","content":"量子场论学习笔记\n\n相对论量子力学的困难和局限性固定粒子数的相对论性量子力学三大困难1）负能解问题：导致任意低的基态，没有稳定真空2）负几率问题：$$\\psi(x)$$不正定（必须放弃波函数的几率解释）3）破坏因果性\nK-G方程连续性方程：$$\\frac{\\partial \\rho}{\\partial t} + \\nabla \\cdot \\vec{\\jmath}&#x3D;0$$$$\\rho&#x3D;NIm(\\phi^{}\\frac{\\partial}{\\partial t})$$$$\\vec{\\jmath}&#x3D;Nc^{2}Im(\\phi^{} \\nabla \\phi)$$其中$\\rho$不正定（KG方程包含时间的二阶导）\nDirac方程连续性方程$$\\partial_{t} \\rho +\\nabla \\cdot \\vec{\\jmath}&#x3D;0$$$$\\rho&#x3D;\\phi^{\\dagger} \\phi $$$$\\vec{\\jmath}&#x3D;c\\phi^{\\dagger} \\vec{\\alpha} \\phi$$其中$$\\rho&#x3D;\\mid \\phi_{1}\\mid ^{2}+ \\dots +|\\phi_{4}|^{2}$$大于零，克服了负几率问题能量$$E&#x3D;\\pm \\sqrt{p^{2}c^{2}+m^{2}c^{4}}$$存在负能解，Dirac解释为Dirac sea，预言了反粒子，提出空穴的概念两个方程关于氢原子能级的解均能计算到精细结构，但是角动量存在差别Dirac方程语言了电子的磁矩$$\\mu&#x3D;\\frac{e \\hbar}{2mc}$$\nDirac 方程的困难电子的反常磁矩兰姆位移\n因果性讨论。。。\n","categories":["公式推导"],"tags":["量子场论"]},{"title":"General_Relativity","url":"/2021/07/06/Special-Relativity/","content":"关于广义相对论的一点数学知识和概念\n\n等效原理弱等效原理：引力场与惯性场的力学效应是局域不可区分的强等效原理：引力场和惯性场的一切物理效应是局域不可区分的惯性系：在引力场中自由下落的无自转的无穷小的参考系\n黎曼几何和张量分析在SR下的定义 （lorentz变化）$$x^{\\prime}{\\mu}&#x3D;a{\\mu \\nu}x_{\\nu}$$$$dx_{\\nu}&#x3D;(a^{-1}){\\nu \\mu}dx^{\\prime}{\\mu}$$$aa^{-1}&#x3D;I$   (坐标变化线性正交) 标量：坐标变化下不变矢量：坐标变化下和坐标微分元一样变的量.$${V^{\\prime}{\\mu}&#x3D;a{\\mu \\nu}V_{\\nu}}$$$${dV^{\\prime}{\\mu}&#x3D;a{\\mu \\nu}dV_{\\nu}}$$张量：坐标变化下,按如下变化的：$$T^{\\prime}{\\mu \\nu}&#x3D;a{\\mu \\alpha}a_{\\nu \\beta}T_{\\alpha \\beta}$$   \n在GR下的定义（广义坐标变化）$x^{\\prime \\mu}&#x3D;x^{\\prime \\mu}(x^{\\nu})$  ,坐标变化既不正交也不线性$$dx^{\\prime \\mu}&#x3D;\\frac{\\partial x^{\\prime \\mu}}{\\partial x^{\\nu}}dx^{\\nu}$$标量：在广义坐标变化下不变的量矢量：在广义坐标变化下和坐标微分元一样变的量（逆变和协变之分）张量：$T^{\\prime \\mu \\nu}&#x3D;\\frac{\\partial x^{\\prime \\mu}}{\\partial x^{\\alpha}}\\frac{\\partial x^{\\prime \\nu}}{\\partial x^{\\beta}}T^{\\alpha \\beta}$   (逆变协变之分)克罗内克尔符号：二阶混合张量（证明）   \n张量代数缩并,对称性\n平移和联络联络定义矢量的平移（计算）i）联络不是张量ii）两个联络之差是张量iii）联络的反对称部分是张量\n协变微商标量场的协变微商就是普通微商,且结果是逆变矢量协变矢量的协变微商：$$A_{\\mu ; \\nu}&#x3D;A_{\\mu , \\nu}-\\Gamma^{\\lambda}{\\mu \\nu}A{\\lambda}$$逆变矢量的协变微商：$$A^{\\mu}{ ; \\nu}&#x3D;A^{\\mu}{ , \\nu}+\\Gamma^{\\mu}_{\\lambda \\nu}A^{\\lambda}$$再用莱布尼兹可以算出其他张量的微商\n测地线和仿射参量曲线的参数方程：$x^{\\mu}&#x3D;x^{\\mu}(\\lambda)$切矢：$A^{\\mu}&#x3D;\\frac{dx^{\\mu}}{d \\lambda}$要求矢量平移后方向相同,可以得到测地线方程：$\\frac{d^{2}x^{\\mu}}{d\\sigma^{2}}+\\Gamma^{\\mu}_{\\alpha \\beta}\\frac{dx^{\\alpha}}{d\\sigma}\\frac{dx^{\\beta}}{d\\sigma}&#x3D;0$曲线上两点平移后切矢量重合,该曲线是测地线。\n曲率与绕率两者之差：$$A_{\\lambda ; \\mu ; \\nu}-A_{\\lambda ; \\nu ; \\mu}&#x3D;R^{\\rho}{\\lambda \\mu ; \\nu}A{\\rho}-2\\Gamma^{\\rho}{[\\nu \\mu]}A{\\lambda ; \\rho}$$前者曲率,后者绕率绕率：矢量平移一周后不能形成封闭空间,空间是扭曲的曲率：矢量平移一周后会有角度差   \n曲率的性质i）后一对指标反对称ii）两种独立的缩并方式（13缩并,12缩并）\n度规和距离平直时空：$g_{\\mu \\nu}$ 是对角元-1和1度规能升降指标矢量的平移：计算联络平移切矢方向不变：计算出测地线平移长度不变：计算联络（克式符）$$\\Gamma^{\\alpha}{\\mu \\nu}&#x3D;\\frac{1}{2}g^{\\alpha \\lambda}(g{\\mu \\lambda , \\nu}+g_{\\nu \\lambda , \\mu}-g_{\\mu \\nu , \\lambda})$$度规的协变微商等于0在一个无绕空间,总能找到一个坐标变化,将时空任意一点的克式符变为0短程线：对两点曲线做变分,计算欧拉拉格朗日方程$$\\frac{d^{2}x^{\\mu}}{ds^{2}}+\\Gamma^{\\mu}_{\\alpha \\beta}\\frac{dx^{\\alpha}}{ds}\\frac{dx^{\\beta}}{ds}&#x3D;0$$  \n黎曼时空的曲率张量$$R^{\\rho}{\\lambda [\\mu \\nu]}$$i）后一对指标反对称ii）存在两种缩并克式符下的曲率张量的对称性$$R{\\rho \\lambda \\mu \\nu}&#x3D;g_{\\rho \\sigma}R^{\\sigma}{\\lambda \\mu \\nu}$$i)后一对指标反对称ii）前一对指标反对称iii）前一对指标与后一对指标对称iiii）里奇恒等式：$$R^{\\rho}{\\lambda \\mu \\nu}+R^{\\rho}{\\mu \\nu \\lambda}+R^{\\sigma}{\\nu \\lambda \\mu}&#x3D;0$$(后三个指标轮转)三个重要派生张量：里奇张量：$$R_{\\mu \\nu}$$  (缩并得到)曲率标量：R（再次缩并）爱因斯坦张量：$$G_{\\mu \\nu}&#x3D;R_{\\mu \\nu}-\\frac{1}{2}R$$毕安基恒等式：（后三个指标轮转的协变微商）$$G^{\\mu \\nu}{ ; \\nu}&#x3D;0$$$$(R{\\mu \\nu}-\\frac{1}{2}R)^{ ; \\nu}&#x3D;0$$\n重要运算度规的微分,广义相对论就是算度规的一阶导数和二阶导数（度规-联络-曲率）特殊的克式符：$$\\Gamma^{\\mu}{\\alpha \\mu}&#x3D;\\frac{\\partial}{\\partial x^{\\alpha}}(\\ln \\sqrt{-g})$$散度运算：$$div A^{\\mu}&#x3D;A^{\\mu}{ ; \\mu}&#x3D;\\frac{1}{\\sqrt{-g}}\\frac{\\partial}{\\partial x^{\\mu}}(\\sqrt{-g}A^{\\mu})$$达郎贝尔算符:$$\\Box&#x3D;div(grad\\Psi)$$旋度运算:$$A_{\\mu ; \\nu}-A_{\\nu ; \\mu}&#x3D;A_{\\mu , \\nu}-A_{\\nu , \\mu}$$\n爱因斯坦方程坐标时和固有时的区别坐标时：$t&#x3D;\\frac{x^{0}}{c}$,没有意义,用与计算和逻辑分析 固有时：$$ds^{2}&#x3D;g_{\\mu \\nu}dx^{\\mu}dx^{\\nu}$$,$dT&#x3D;\\frac{ids}{c}&#x3D;d \\tau$两者联系：$$d\\tau&#x3D;\\sqrt{-g_{00}}dt$$这也是地球太阳时间间隔区别,太阳附近要乘以太阳的度规：$${g_{00}}$$能量动量张量：电磁场：$$T^{\\mu \\nu}&#x3D;\\frac{1}{4\\pi}(F^{\\mu}{\\lambda}F^{\\lambda \\nu}-\\frac{1}{4}g^{\\mu \\nu}F{\\rho \\lambda}F^{\\rho \\lambda})$$理想流体：$T^{\\mu \\nu}&#x3D;(\\rho+\\frac{P}{c^{2}})u^{\\mu}u^{\\nu}+Pg^{\\mu \\nu}$松散介质,非相对论理想流体：$T^{\\mu \\nu}&#x3D;\\rho u^{\\mu}u^{\\nu}$坐标条件和边界条件:协和坐标系：$g^{\\mu \\nu}\\Gamma^{\\lambda}_{\\mu \\nu}&#x3D;0$   \n应用史瓦西解静态球对称物体,解出度规：$$ds^{2}&#x3D;-c^{2}(1-\\frac{2GM}{c^{2}r})dt^{2}+(1-\\frac{2GM}{c^{2}r})^{-1}dr^{2}+r^{2}d\\theta^{2}+r^{2}sin^{2}\\theta d\\phi^{2}$$地球上的钟:$$d\\tau_{2}$$ 太阳上的钟:$$d\\tau_{1}$$ 两者差距$g_{00}$:$$d\\tau_{2}&#x3D;(1-\\frac{2GM}{c^{2}r})^{-1&#x2F;2}d\\tau_{2}$$引力红移: $$v&#x3D;v_{0}\\sqrt{1-\\frac{2GM}{c^{2}r}}$$水星进动史瓦西黑洞：静态球对称克尔纽曼黑洞：带电旋转\n","categories":["公式推导"],"tags":["General_Relativity"]},{"title":"cuda-1","url":"/2024/08/17/cuda-1/","content":"编程过程中一般都是这样一个流程：本地有data，有config文件需要先读取到CPU，然后计算逻辑写在GPU，将data和config的配置文件传给GPU，算完之后的结果再传给CPU，最后CPU再写入到本地。所以第一件事就是搞清楚数据在cpu和gpu上的传输。\n\n\n第一章 获取GPU数据cudaMalloc前面提到，__global__函数不能有返回值，类型必须要void，那么我们怎么获得GPU的数据呢？答案是指针：\n#include &lt;cstdio&gt;#include &lt;cuda_runtime.h&gt;__global__ void kernel(int *pret) &#123; *pret = 42; &#125;auto main() -&gt; int&#123;    int ret = 0; (栈上分配)    kernel&lt;&lt;&lt;1, 1&gt;&gt;&gt;(&amp;ret);    //int *pret = (int *)malloc(sizeof(int)); (堆上分配)    //kernel&lt;&lt;&lt;1, 1&gt;&gt;&gt;(pret);    cudaDeviceSynchronize();    printf(&quot;%d\\n&quot;, ret);    return 0;&#125;\n\n这段代码无论是栈上分配内存还是堆上分配内存，传给GPU都不会改变传入的指针的值，根本原因在于这都是cpu上的内存，而cpu和GPU有着各自独立的内存，分别称为主机内存和设备内存，后者也叫显存，为什么要独立的显存，因为cpu上的内存太慢，所以GPU自己搭载了一块内存。因此无论是栈上还是堆上，都是cpu的内存，GPU自然无法访问到，需要cuda特有的内存分配函数cudaMalloc：\n#include &lt;cstdio&gt;#include &lt;cuda_runtime.h&gt;__global__ void kernel(int *pret) &#123; *pret = 42; &#125;auto main() -&gt; int&#123;    int *pret;    cudaMalloc(&amp;pret, sizeof(int));    kernel&lt;&lt;&lt;1, 1&gt;&gt;&gt;(pret);    cudaDeviceSynchronize();    int ret;    cudaMemcpy(&amp;ret, pret, sizeof(int), cudaMemcpyDeviceToHost);    printf(&quot;%d\\n&quot;, ret);    cudaFree(pret);    return 0;&#125;❯ ./a.out42\n\n上述代码，先通过cudaMalloc在GPU上分配内存，此时kernel函数便能访问到这块地址，但是这块地址cpu是不能访问的！所以我们还需要cudaMemcpy拷贝数据到cpu。最后cudaFree释放掉GPU上的内存。看起来好像很麻烦，拷来拷去，不就影响性能了吗？\nUnified Memory有一种新的特性，叫统一内存(managed)，cudaMallocManaged代替cudaMalloc，这样会同时在cpu和gpu上分配地址，并且内存地址使一模一样的，假如gpu上有数据写入到这个地址，cpu上的地址会自动同步数据，这样就省略了手动调用cudaMemcpy。\n#include &lt;cstdio&gt;#include &lt;cuda_runtime.h&gt;__global__ void kernel(int *pret) &#123; *pret = 42; &#125;auto main() -&gt; int&#123;    int *pret;    cudaMallocManaged(&amp;pret, sizeof(int));    kernel&lt;&lt;&lt;1, 1&gt;&gt;&gt;(pret);    cudaDeviceSynchronize();    printf(&quot;result = %d\\n&quot;, *pret);    cudaFree(pret);    return 0;&#125;❯ ./a.outresult = 42\n\n分配数组可以用n*sizeof(int)分配大小为n的整形数组，这样会有n个连续的int数据排列在内存中，arr指向起始地址，将arr传入核函数，就可以通过下标访问数组元素：\n#include &lt;cstdio&gt;#include &lt;cuda_runtime.h&gt;__global__ void kernel(int *arr, int n)&#123;    for (int i = 0; i &lt; n; i++) arr[i] = i;&#125;auto main() -&gt; int&#123;    int  n   = 4;    int *arr = nullptr;    cudaMallocManaged(&amp;arr, n * sizeof(int));    kernel&lt;&lt;&lt;1, 1&gt;&gt;&gt;(arr, n);    cudaDeviceSynchronize();    for (int i = 0; i &lt; n; i++) printf(&quot;arr[%d]: %d\\n&quot;, i, arr[i]);    cudaFree(arr);    return 0;&#125;❯ ./a.outarr[0]: 0arr[1]: 1arr[2]: 2arr[3]: 3\n上面的代码只启动了一个线程一个block，核函数内部的for循环是串行的，这里可以因为数组大小是n，我们可以把线程数量设置为n，将数组下标转化为线程的编号，这样就扔掉了for循环：\n#include &lt;cstdio&gt;#include &lt;cuda_runtime.h&gt;__global__ void kernel(int *arr, int n)&#123;    int i  = threadIdx.x;    arr[i] = i;&#125;auto main() -&gt; int&#123;    int  n   = 4;    int *arr = nullptr;    cudaMallocManaged(&amp;arr, n * sizeof(int));    kernel&lt;&lt;&lt;1, n&gt;&gt;&gt;(arr, n);    cudaDeviceSynchronize();    for (int i = 0; i &lt; n; i++) printf(&quot;arr[%d]: %d\\n&quot;, i, arr[i]);    cudaFree(arr);    return 0;&#125;❯ ./a.outarr[0]: 0arr[1]: 1arr[2]: 2arr[3]: 3\n网格\n","tags":["cuda"]},{"title":"cuda 入门","url":"/2024/08/16/cuda-%E5%85%A5%E9%97%A8/","content":"学习cuda的一些笔记。\n\n\n第0章cuda有两套API，cuda runtime API和cuda driver API，前者简单兼顾性能，无需手动编译kernel，但不够灵活，后者灵活多变，但是操作繁琐，适合有特殊需求的用户，这个笔记只记录比较易懂，使用最多的runtime API。先阐述一些概念和语法\nglobal host device#include &lt;cuda_runtime.h&gt;#include &lt;cstdio&gt;__device__ void say_hello_device() &#123; printf(&quot;hello world from GPU!\\n&quot;); &#125;__host__ void say_hello_host() &#123; printf(&quot;hello world from CPU!\\n&quot;); &#125;__host__ __device__ void say_hello() &#123; printf(&quot;hello world!\\n&quot;); &#125;__host__ __device__ void say_hello_select() &#123;#ifdef __CUDA_ARCH__    printf(&quot;hello world from GPU!\\n&quot;);#else    printf(&quot;hello world from CPU!\\n&quot;);#endif&#125;__global__ void cuda_hello() &#123;  say_hello_device();  say_hello();&#125;auto main() -&gt; int&#123;    cuda_hello&lt;&lt;&lt;1, 10&gt;&gt;&gt;();    cudaDeviceSynchronize();    say_hello_host();    say_hello();    return 0;&#125;\n\n\n__global__修饰的函数叫核函数，是可以在main函数中调用的，运行在GPU(device)上，需要指定特殊的参数&lt;&lt;&lt;a,b&gt;&gt;&gt;。\n__device__修饰的函数叫设备函数，只能在GPU上运行，main函数内无法调用,只能由device函数或者global函数调用。\n__host__修饰的函数是host函数，定义在cpu上。cuda完全兼容c++，任何函数默认都是host。\nhost和device可以一起用，相当于同时把函数定义在cpu和gpu上。也可以使用__CUDA_ARCH__宏生成两份源代码。\n__global__函数可以有参数，但不能有返回值，只能是void类型。也就是说，我们不可能从核函数通过返回值来获取GPU数据。\n__global__是异步的，所以每个global函数执行完后必须加cudaDeviceSynchronize等待GPU计算完毕\n\nCUDA_ARCH如果打印__CUDA_ARCH__，会发现这是一个整数，代表的是版本号:\n__host__ __device__ void say_hello()&#123;#ifdef __CUDA_ARCH__printf(&quot;Hello, world GPU arch %d!\\n&quot;, __CUDA_ARCH__);#else    printf(&quot;Hello, world CPU!\\n&quot;);#endif&#125;Hello, world GPU arch 520!\n这里的520代表版本号是5.2.0，默认是兼容最老的版本52，也就是GTX900以上，有了这个就可以根据不同的GPU架构来编译出不同的源码：\n__host__ __device__ func()&#123;#ifdef __CUDA_ARCH__ &gt;= 700    // device code path for compute capability 7.x#elif __CUDA_ARCH__ &gt;=600    // device code path for compute capability 6.x// others#elif !defined(__CUDA_ARCH__)    //host code#endif&#125;\n在cmake中，可以指定native来检测本地机器的计算能力，也可以自动设定为特定的版本：\nset(CMAKE_CUDA_ARCHITECTURES &quot;native&quot;)set(CMAKE_CUDA_ARCHITECTURES 52;70;75;86)\nconstexpr相当于把constexpr 函数自动变成cpu和gpu都可以调用，通常都是一些可以内联的函数，数学表达式，不依赖cpu和gpu，没有外部副作用:\n#include &lt;cstdio&gt;#include &lt;cuda_runtime.h&gt;constexpr auto cuthead(const char *p) -&gt; const char * &#123; return p + 1; &#125;__global__ void kernel() &#123; printf(cuthead(&quot;Hello, world!\\n&quot;)); &#125;auto main() -&gt; int&#123;    kernel&lt;&lt;&lt;1, 1&gt;&gt;&gt;();    cudaDeviceSynchronize();    printf(cuthead(&quot;Hello, world!\\n&quot;));    return 0;&#125;\n\n编译需要添加参数:\nnvcc -ccbin gcc-13 constexpr.cu --expt-relaxed-constexpr./a.outello, world!ello, world!\n\nconstexpr没法调用printf，也不能用__syncthreads之类的GPU函数，所以也不能完全代替__host__和__device__。\nthread block grid#include &lt;cstdio&gt;#include &lt;cuda_runtime.h&gt;__global__ void kernel()&#123;    printf(&quot;Hello, world!\\n&quot;));    printf(&quot;threadIdx.x %d of %d\\n&quot;, threadIdx.x, blockDim.x);&#125;auto main() -&gt; int&#123;    kernel&lt;&lt;&lt;1, 3&gt;&gt;&gt;();    cudaDeviceSynchronize();    return 0;&#125;# 输出hello world from GPU!hello world from GPU!hello world from GPU!threadIdx.x 0 of 3threadIdx.x 1 of 3threadIdx.x 2 of 3\n运行这个代码会打印三次，这个很奇怪的语法&lt;&lt;&lt;1,3&gt;&gt;&gt;是核函数独有的参数，第二个参数代表了线程的数量。GPU是为了并行而生的，可以启动相当大的线程数量，不像cpu有核数的限制。第二个打印语句中的threadIdx.x，就是CUDA的特殊变量，只有在核函数中才可以访问，可以看到打印出了0，1，2三个数字，因为我们指定了线程数为3，代表了线程的编号，第二个blockDIm则代表了线程的数量，也就是尖括号内指定的3，为什么有个.x后缀呢？如果我们把尖括号的第一个参数改成2呢？\n#include &lt;cstdio&gt;#include &lt;cuda_runtime.h&gt;__global__ void kernel()&#123;    printf(&quot;threadIdx.x %d of %d\\n&quot;, threadIdx.x, blockDim.x);&#125;auto main() -&gt; int&#123;    kernel&lt;&lt;&lt;2, 3&gt;&gt;&gt;();    cudaDeviceSynchronize();    return 0;&#125;threadIdx.x 0 of 3threadIdx.x 1 of 3threadIdx.x 2 of 3threadIdx.x 0 of 3threadIdx.x 1 of 3threadIdx.x 2 of 3\n这里就是CUDA的另一个概念，block，这是一个比线程更大的概念，block可以组织线程，一个block可以由多个线程组成，blockDim就代表一个block的维度大小，而block的数量可以用尖括号第一个参数指定。&lt;&lt;&lt;2,3&gt;&gt;&gt;代表我们启动了两个block，每个block启动3个线程，一共6个线程。同样，要获取block的编号类似线程编号，使用blockIdx.x，获取block的数量，则使用gridDim.x。那么这个grid又是什么呢？\n__global__ void cuda_hello()&#123;    printf(&quot;blockIdx.x %d of %d, threadIdx.x %d of %d\\n&quot;, blockIdx.x, gridDim.x, threadIdx.x, blockDim.x);&#125;auto main() -&gt; int&#123;    cuda_hello&lt;&lt;&lt;2, 3&gt;&gt;&gt;();    cudaDeviceSynchronize();    return 0;&#125;blockIdx.x 1 of 2, threadIdx.x 0 of 3blockIdx.x 1 of 2, threadIdx.x 1 of 3blockIdx.x 1 of 2, threadIdx.x 2 of 3blockIdx.x 0 of 2, threadIdx.x 0 of 3blockIdx.x 0 of 2, threadIdx.x 1 of 3blockIdx.x 0 of 2, threadIdx.x 2 of 3\n从这里就可以看出，CUDA中由block组织线程，由grid组织block，这里一共6个线程。总结一下：\n\nthread：最小并行单位\nblock：组织若干线程\ngrid：组织整个任务，包含若干block\n调用语法：&lt;&lt;&lt;gridDim,blockDim&gt;&gt;&gt;\n\n一个有用的技巧，扁平化处理这些线程和block：总线程数量：blockDim x gridDim总线程编号：blockDim x blockIdx + threadIdx(其实就是二维数组的一维索引)\n__global__ void cuda_hello()&#123;    unsigned int tnum = gridDim.x * blockDim.x;    unsigned int tid = threadIdx.x + blockIdx.x * blockDim.x;    printf(&quot;tid %d of %d\\n&quot;, tid, tnum);&#125;auto main() -&gt; int&#123;    cuda_hello&lt;&lt;&lt;2, 3&gt;&gt;&gt;();    cudaDeviceSynchronize();    return 0;&#125;tid 3 of 6tid 4 of 6tid 5 of 6tid 0 of 6tid 1 of 6tid 2 of 6\n可以看到，我们设置了6个线程，并且每个线程的id都正确的计算了，下面的示意图展示了其中的关系：\n3D grid and block根据上面block和thread的后缀.x可以猜测，肯定有.y和.z的后缀吧。cuda支持三维的block和线程区间，只需要将尖括号内改成dim3类型即可:\n#include &lt;cstdio&gt;#include &lt;cuda_runtime.h&gt;__global__ void kernel()&#123;    printf(&quot;Block (%d, %d, %d) of (%d, %d, %d), Thread (%d, %d, %d) of (%d, %d, &quot;           &quot;%d)\\n&quot;,           blockIdx.x, blockIdx.y, blockIdx.z, gridDim.x, gridDim.y, gridDim.z, threadIdx.x,           threadIdx.y, threadIdx.z, blockDim.x, blockDim.y, blockDim.z);&#125;auto main() -&gt; int&#123;    kernel&lt;&lt;&lt;dim3(2, 1, 3), dim3(2, 2, 2)&gt;&gt;&gt;();    cudaDeviceSynchronize();    return 0;&#125;\nBlock (0, 0, 1) of (2, 1, 3), Thread (0, 0, 0) of (2, 2, 2)Block (0, 0, 1) of (2, 1, 3), Thread (1, 0, 0) of (2, 2, 2)Block (0, 0, 1) of (2, 1, 3), Thread (0, 1, 0) of (2, 2, 2)Block (0, 0, 1) of (2, 1, 3), Thread (1, 1, 0) of (2, 2, 2)Block (0, 0, 1) of (2, 1, 3), Thread (0, 0, 1) of (2, 2, 2)Block (0, 0, 1) of (2, 1, 3), Thread (1, 0, 1) of (2, 2, 2)Block (0, 0, 1) of (2, 1, 3), Thread (0, 1, 1) of (2, 2, 2)Block (0, 0, 1) of (2, 1, 3), Thread (1, 1, 1) of (2, 2, 2)Block (1, 0, 0) of (2, 1, 3), Thread (0, 0, 0) of (2, 2, 2)Block (1, 0, 0) of (2, 1, 3), Thread (1, 0, 0) of (2, 2, 2)Block (1, 0, 0) of (2, 1, 3), Thread (0, 1, 0) of (2, 2, 2)Block (1, 0, 0) of (2, 1, 3), Thread (1, 1, 0) of (2, 2, 2)Block (1, 0, 0) of (2, 1, 3), Thread (0, 0, 1) of (2, 2, 2)Block (1, 0, 0) of (2, 1, 3), Thread (1, 0, 1) of (2, 2, 2)Block (1, 0, 0) of (2, 1, 3), Thread (0, 1, 1) of (2, 2, 2)Block (1, 0, 0) of (2, 1, 3), Thread (1, 1, 1) of (2, 2, 2)Block (1, 0, 1) of (2, 1, 3), Thread (0, 0, 0) of (2, 2, 2)Block (1, 0, 1) of (2, 1, 3), Thread (1, 0, 0) of (2, 2, 2)Block (1, 0, 1) of (2, 1, 3), Thread (0, 1, 0) of (2, 2, 2)Block (1, 0, 1) of (2, 1, 3), Thread (1, 1, 0) of (2, 2, 2)Block (1, 0, 1) of (2, 1, 3), Thread (0, 0, 1) of (2, 2, 2)Block (1, 0, 1) of (2, 1, 3), Thread (1, 0, 1) of (2, 2, 2)Block (1, 0, 1) of (2, 1, 3), Thread (0, 1, 1) of (2, 2, 2)Block (1, 0, 1) of (2, 1, 3), Thread (1, 1, 1) of (2, 2, 2)Block (1, 0, 2) of (2, 1, 3), Thread (0, 0, 0) of (2, 2, 2)Block (1, 0, 2) of (2, 1, 3), Thread (1, 0, 0) of (2, 2, 2)Block (1, 0, 2) of (2, 1, 3), Thread (0, 1, 0) of (2, 2, 2)Block (1, 0, 2) of (2, 1, 3), Thread (1, 1, 0) of (2, 2, 2)Block (1, 0, 2) of (2, 1, 3), Thread (0, 0, 1) of (2, 2, 2)Block (1, 0, 2) of (2, 1, 3), Thread (1, 0, 1) of (2, 2, 2)Block (1, 0, 2) of (2, 1, 3), Thread (0, 1, 1) of (2, 2, 2)Block (1, 0, 2) of (2, 1, 3), Thread (1, 1, 1) of (2, 2, 2)Block (0, 0, 0) of (2, 1, 3), Thread (0, 0, 0) of (2, 2, 2)Block (0, 0, 0) of (2, 1, 3), Thread (1, 0, 0) of (2, 2, 2)Block (0, 0, 0) of (2, 1, 3), Thread (0, 1, 0) of (2, 2, 2)Block (0, 0, 0) of (2, 1, 3), Thread (1, 1, 0) of (2, 2, 2)Block (0, 0, 0) of (2, 1, 3), Thread (0, 0, 1) of (2, 2, 2)Block (0, 0, 0) of (2, 1, 3), Thread (1, 0, 1) of (2, 2, 2)Block (0, 0, 0) of (2, 1, 3), Thread (0, 1, 1) of (2, 2, 2)Block (0, 0, 0) of (2, 1, 3), Thread (1, 1, 1) of (2, 2, 2)Block (0, 0, 2) of (2, 1, 3), Thread (0, 0, 0) of (2, 2, 2)Block (0, 0, 2) of (2, 1, 3), Thread (1, 0, 0) of (2, 2, 2)Block (0, 0, 2) of (2, 1, 3), Thread (0, 1, 0) of (2, 2, 2)Block (0, 0, 2) of (2, 1, 3), Thread (1, 1, 0) of (2, 2, 2)Block (0, 0, 2) of (2, 1, 3), Thread (0, 0, 1) of (2, 2, 2)Block (0, 0, 2) of (2, 1, 3), Thread (1, 0, 1) of (2, 2, 2)Block (0, 0, 2) of (2, 1, 3), Thread (0, 1, 1) of (2, 2, 2)Block (0, 0, 2) of (2, 1, 3), Thread (1, 1, 1) of (2, 2, 2)\n因为GPU的业务常常涉及到图形学和二维图像，所以有3维结构处理会比较方便。也可以将所有线程的id展开为一维索引，本质没有区别。初看可能很疑惑，我只需要6个线程，直接线程数设置为6就行了，为什么要分block和grid呢？还搞成3d这样复杂的结构？其实这正是cuda编程的核心，同样的代码，如果线程的结构组织不一样，运行效率天差地别。\n总结介绍一些cuda编程的基本概念与语法，主机端和设备端的函数区别，了解线程的组织关系。\n虽然cuda基于C++，但是runtime的api依然是仿c风格的接口，可能是为了照顾从c转过来的土木老哥，也有可能是为了方便被第三方二次封装\n","tags":["cuda"]},{"title":"ftp服务器开启","url":"/2021/06/29/ftp/","content":"linux开启ftp服务器，并配合客户端filezilla实现文件传输\n\n下载vsftpdsudo pacman -S vsftpdsudo vim /etc/vsftpd.conf\n打开配置文件，设置如下：\nanonymous_enable=NOlocal_enable=YESwrite_enable=YESallow_writeable_chroot=YESlocal_umask=022dirmessage_enable=YESxferlog_enable=YESconnect_from_port_20=YESchroot_local_user=YESchroot_list_enable=NO(禁止访问home以上的区域)listen=YESpam_service_name=vsftpdseccomp_sandbox=NOisolate_network=NO\n最后重启服务\nsudo systemctl restart vsftpd\nwindows下载filezilla，新建站点，输入ip，用户名密码，连接即可，愉快的拖文件吧可以看到我们只能访问用户目录，进不了root区，进去也是一片问号啥也看不了，再也不用U盘拷过来拷过去，手机文件用kdeconnect，kde桌面自带的和西欧\n","categories":["linux"],"tags":["ftp"]},{"title":"hexo的搭建","url":"/2021/09/23/hexo/","content":"heox+github+sublime 搭建博客\n\n必备nodejs，npm，git\nsudo pacman -S npm \n一般会自动下载node，检查下版本号\n命令新建blog文件夹 \nnpm install -g hexo-cli --save\n如果下载失败设置代理\nnpm config set proxy http://xxx.x.x.x::portnpm config set registry https://registry.npmjs.org\n初始化\nhexo init\n下载文件\nnpm install\n下载主题\nnpm install hexo-theme-next如果下载失败，到github下载npm install hexo-deployer-git --save\n站点配置# Hexo Configuration## Docs: https://hexo.io/docs/configuration.html## Source: https://github.com/hexojs/hexo/# Sitetitle: The Seven Heavensubtitle: &#x27;&#x27;description: 一名科研狗的随手记keywords:author: marigoldlanguage: zh-CNtimezone: &#x27;&#x27;# URL## Set your site url here. For example, if you use GitHub Page, set url as &#x27;https://username.github.io/project&#x27;url: http://marigold0225.github.iopermalink: :year/:month/:day/:title/permalink_defaults:pretty_urls:  trailing_index: true # Set to false to remove trailing &#x27;index.html&#x27; from permalinks  trailing_html: true # Set to false to remove trailing &#x27;.html&#x27; from permalinks# Directorysource_dir: sourcepublic_dir: publictag_dir: tagsarchive_dir: archivescategory_dir: categoriescode_dir: downloads/codei18n_dir: :langskip_render:# Writingnew_post_name: :title.md # File name of new postsdefault_layout: posttitlecase: false # Transform title into titlecaseexternal_link:  enable: true # Open external links in new tab  field: site # Apply to the whole site  exclude: &#x27;&#x27;filename_case: 0render_drafts: falsepost_asset_folder: truerelative_link: falsefuture: truehighlight:  enable: true  line_number: true  auto_detect: false  tab_replace: &#x27;&#x27;  wrap: true  hljs: falseprismjs:  enable: false  preprocess: true  line_number: true  tab_replace: &#x27;&#x27;# Home page setting# path: Root path for your blogs index page. (default = &#x27;&#x27;)# per_page: Posts displayed per page. (0 = disable pagination)# order_by: Posts order. (Order by date descending by default)index_generator:  path: &#x27;&#x27;  per_page: 10  order_by: -date# Category &amp; Tagdefault_category: uncategorizedcategory_map:tag_map:# Metadata elements## https://developer.mozilla.org/en-US/docs/Web/HTML/Element/metameta_generator: true# Date / Time format## Hexo uses Moment.js to parse and display date## You can customize the date format as defined in## http://momentjs.com/docs/#/displaying/format/date_format: YYYY-MM-DDtime_format: HH:mm:ss## updated_option supports &#x27;mtime&#x27;, &#x27;date&#x27;, &#x27;empty&#x27;updated_option: &#x27;mtime&#x27;# Pagination## Set per_page to 0 to disable paginationper_page: 10pagination_dir: page# Include / Exclude file(s)## include:/exclude: options only apply to the &#x27;source/&#x27; folderinclude:exclude:ignore:# Extensions## Plugins: https://hexo.io/plugins/## Themes: https://hexo.io/themes/theme: next# Deployment## Docs: https://hexo.io/docs/one-command-deploymentdeploy:  type: git  repo:     github: git@github.com:marigold0225/marigold0225.github.io.git  branch: master# hexo-renderer-pandoc (https://github.com/wzpan/hexo-renderer-pandoc)pandoc:#  extra:  #  - toc: # will be passed as `--toc`. Note the colon，如果不需要自动生成目录无需添加此行  extensions:    - &#x27;+hard_line_breaks&#x27;    - &#x27;+emoji&#x27;    - &#x27;-implicit_figures&#x27;  mathEngine: mathjax  #  template:#    ./pandoc_template.html # 如果不需要自动生成目录无需添加此行# -----------------------------------------------------markdown:  plugins:    - markdown-it-footnote    - markdown-it-sup    - markdown-it-sub    - markdown-it-abbr    - markdown-it-emoji    - hexo-math\n主题配置# ---------------------------------------------------------------# Theme Core Configuration Settings# See: https://theme-next.org/docs/theme-settings/# ---------------------------------------------------------------# If false, merge configs from `_data/next.yml` into default configuration (rewrite).# If true, will fully override default configuration by options from `_data/next.yml` (override). Only for NexT settings.# And if true, all config from default NexT `_config.yml` have to be copied into `next.yml`. Use if you know what you are doing.# Useful if you want to comment some options from NexT `_config.yml` by `next.yml` without editing default config.override: false# Console reminder if new version released.reminder: false# Allow to cache content generation. Introduced in NexT v6.0.0.cache:  enable: true# Remove unnecessary files after hexo generate.minify: false# Define custom file paths.# Create your custom files in site directory `source/_data` and uncomment needed files below.custom_file_path:  #head: source/_data/head.swig  #header: source/_data/header.swig  #sidebar: source/_data/sidebar.swig  #postMeta: source/_data/post-meta.swig  #postBodyEnd: source/_data/post-body-end.swig  #footer: source/_data/footer.swig  #bodyEnd: source/_data/body-end.swig  #variable: source/_data/variables.styl  #mixin: source/_data/mixins.styl  style: source/_data/styles.styl# ---------------------------------------------------------------# Site Information Settings# See: https://theme-next.org/docs/getting-started/# ---------------------------------------------------------------favicon:  small: /images/favicon-16x16-next.png  medium: /images/favicon-32x32-next.png  apple_touch_icon: /images/apple-touch-icon-next.png  safari_pinned_tab: /images/logo.svg  #android_manifest: /images/manifest.json  #ms_browserconfig: /images/browserconfig.xml# Show multilingual switcher in footer.language_switcher: falsefooter:  # Specify the date when the site was setup. If not defined, current year will be used.  since: 2021  # Icon between year and copyright info.  icon:    # Icon name in Font Awesome. See: https://fontawesome.com/icons    name: fa fa-heart    # If you want to animate the icon, set it to true.    animated: false    # Change the color of icon, using Hex Code.    color: &quot;#ff0000&quot;  # If not defined, `author` from Hexo `_config.yml` will be used.  copyright:  # Powered by Hexo &amp; NexT  powered: true  # Beian ICP and gongan information for Chinese users. See: https://beian.miit.gov.cn, http://www.beian.gov.cn  beian:    enable: false    icp:    # The digit in the num of gongan beian.    gongan_id:    # The full num of gongan beian.    gongan_num:    # The icon for gongan beian. See: http://www.beian.gov.cn/portal/download    gongan_icon_url:# Creative Commons 4.0 International License.# See: https://creativecommons.org/share-your-work/licensing-types-examples# Available values of license: by | by-nc | by-nc-nd | by-nc-sa | by-nd | by-sa | zero# You can set a language value if you prefer a translated version of CC license, e.g. deed.zh# CC licenses are available in 39 languages, you can find the specific and correct abbreviation you need on https://creativecommons.orgcreative_commons:  license: by-nc-sa  sidebar: false  post: false  language:# ---------------------------------------------------------------# Scheme Settings# ---------------------------------------------------------------# Schemes#scheme: Muse#scheme: Mist#scheme: Piscesscheme: Gemini# Dark Modedarkmode: false# ---------------------------------------------------------------# Menu Settings# ---------------------------------------------------------------# Usage: `Key: /link/ || icon`# Key is the name of menu item. If the translation for this item is available, the translated text will be loaded, otherwise the Key name will be used. Key is case-senstive.# Value before `||` delimiter is the target link, value after `||` delimiter is the name of Font Awesome icon.# When running the site in a subdirectory (e.g. yoursite.com/blog), remove the leading slash from link value (/archives -&gt; archives).# External url should start with http:// or https://menu:  home: / || fa fa-home  about: /about/ || fa fa-user  tags: /tags/ || fa fa-tags  categories: /categories/ || fa fa-th  archives: /archives/ || fa fa-archive  #schedule: /schedule/ || fa fa-calendar  #sitemap: /sitemap.xml || fa fa-sitemap  #commonweal: /404/ || fa fa-heartbeat# Enable / Disable menu icons / item badges.menu_settings:  icons: true  badges: false# ---------------------------------------------------------------# Sidebar Settings# See: https://theme-next.org/docs/theme-settings/sidebar# ---------------------------------------------------------------sidebar:  # Sidebar Position.  position: left  #position: right  # Manual define the sidebar width. If commented, will be default for:  # Muse | Mist: 320  # Pisces | Gemini: 240  #width: 300  # Sidebar Display (only for Muse | Mist), available values:  #  - post    expand on posts automatically. Default.  #  - always  expand for all pages automatically.  #  - hide    expand only when click on the sidebar toggle icon.  #  - remove  totally remove sidebar including sidebar toggle.  display: post  # Sidebar padding in pixels.  padding: 18  # Sidebar offset from top menubar in pixels (only for Pisces | Gemini).  offset: 12  # Enable sidebar on narrow view (only for Muse | Mist).  onmobile: false# Sidebar Avataravatar:  # Replace the default image and set the url here.  url: /images/author.jpg  # If true, the avatar will be dispalyed in circle.  rounded: false  # If true, the avatar will be rotated with the cursor.  rotated: false# Posts / Categories / Tags in sidebar.site_state: true# Social Links# Usage: `Key: permalink || icon`# Key is the link label showing to end users.# Value before `||` delimiter is the target permalink, value after `||` delimiter is the name of Font Awesome icon.social:  GitHub: https://github.com/marigold0225 || fab fa-github  E-Mail: mailto:mflovelky418@gmail.com || fa fa-envelope  #Weibo: https://weibo.com/yourname || fab fa-weibo  #Google: https://plus.google.com/yourname || fab fa-google  #Twitter: https://twitter.com/yourname || fab fa-twitter  #FB Page: https://www.facebook.com/yourname || fab fa-facebook  #StackOverflow: https://stackoverflow.com/yourname || fab fa-stack-overflow  #YouTube: https://youtube.com/yourname || fab fa-youtube  #Instagram: https://instagram.com/yourname || fab fa-instagram  #Skype: skype:yourname?call|chat || fab fa-skypesocial_icons:  enable: true  icons_only: false  transition: false# Blog rollslinks_settings:  icon: fa fa-link  title: Links  # Available values: block | inline  layout: blocklinks:  #Title: http://yoursite.com# Table of Contents in the Sidebar# Front-matter variable (unsupport wrap expand_all).toc:  enable: true  # Automatically add list number to toc.  number: true  # If true, all words will placed on next lines if header width longer then sidebar width.  wrap: false  # If true, all level of TOC in a post will be displayed, rather than the activated part of it.  expand_all: false  # Maximum heading depth of generated toc.  max_depth: 6# A button to open designated chat widget in sidebar.# Firstly, you need enable the chat service you want to activate its sidebar button.chat:  enable: false  #service: chatra  #service: tidio  icon: fa fa-comment # Icon name in Font Awesome, set false to disable icon.  text: Chat # Button text, change it as you wish.# ---------------------------------------------------------------# Post Settings# See: https://theme-next.org/docs/theme-settings/posts# ---------------------------------------------------------------# Automatically excerpt description in homepage as preamble text.excerpt_description: true# Read more button# If true, the read more button will be displayed in excerpt section.read_more_btn: true# Post meta display settingspost_meta:  item_text: true  created_at: true  updated_at:    enable: true    another_day: true  categories: true# Post wordcount display settings# Dependencies: https://github.com/theme-next/hexo-symbols-count-timesymbols_count_time:  separated_meta: true  item_text_post: true  item_text_total: false# Use icon instead of the symbol # to indicate the tag at the bottom of the posttag_icon: false# Reward (Donate)# Front-matter variable (unsupport animation).reward_settings:  # If true, reward will be displayed in every article by default.  enable: false  animation: false  #comment: Donate comment here.reward:  #wechatpay: /images/wechatpay.png  #alipay: /images/alipay.png  #paypal: /images/paypal.png  #bitcoin: /images/bitcoin.png# Subscribe through Telegram Channel, Twitter, etc.# Usage: `Key: permalink || icon` (Font Awesome)follow_me:  #Twitter: https://twitter.com/username || fab fa-twitter  #Telegram: https://t.me/channel_name || fab fa-telegram  #WeChat: /images/wechat_channel.jpg || fab fa-weixin  #RSS: /atom.xml || fa fa-rss# Related popular posts# Dependencies: https://github.com/tea3/hexo-related-popular-postsrelated_posts:  enable: false  title: # Custom header, leave empty to use the default one  display_in_home: false  params:    maxCount: 5    #PPMixingRate: 0.0    #isDate: false    #isImage: false    #isExcerpt: false# Post edit# Dependencies: https://github.com/hexojs/hexo-deployer-gitpost_edit:  enable: false  url: https://github.com/user-name/repo-name/tree/branch-name/subdirectory-name # Link for view source  #url: https://github.com/user-name/repo-name/edit/branch-name/subdirectory-name # Link for fork &amp; edit# Show previous post and next post in post footer if exists# Available values: left | right | falsepost_navigation: left# ---------------------------------------------------------------# Custom Page Settings# See: https://theme-next.org/docs/theme-settings/custom-pages# ---------------------------------------------------------------# TagCloud settings for tags page.tagcloud:  # All values below are same as default, change them by yourself.  min: 12 # Minimun font size in px  max: 30 # Maxium font size in px  start: &quot;#ccc&quot; # Start color (hex, rgba, hsla or color keywords)  end: &quot;#111&quot; # End color (hex, rgba, hsla or color keywords)  amount: 200 # Amount of tags, change it if you have more than 200 tags# Google Calendar# Share your recent schedule to others via calendar page.calendar:  calendar_id: &lt;required&gt; # Your Google account E-Mail  api_key: &lt;required&gt;  orderBy: startTime  offsetMax: 24 # Time Range  offsetMin: 4 # Time Range  showDeleted: false  singleEvents: true  maxResults: 250# ---------------------------------------------------------------# Misc Theme Settings# ---------------------------------------------------------------# Set the text alignment in posts / pages.text_align:  # Available values: start | end | left | right | center | justify | justify-all | match-parent  desktop: justify  mobile: justify# Reduce padding / margin indents on devices with narrow width.mobile_layout_economy: false# Android Chrome header panel color ($brand-bg / $headband-bg =&gt; $black-deep).android_chrome_color: &quot;#222&quot;# Custom Logo (Do not support scheme Mist)custom_logo: #/uploads/custom-logo.jpgcodeblock:  # Code Highlight theme  # Available values: normal | night | night eighties | night blue | night bright | solarized | solarized dark | galactic  # See: https://github.com/chriskempson/tomorrow-theme  highlight_theme: normal  # Add copy button on codeblock  copy_button:    enable: false    # Show text copy result.    show_result: false    # Available values: default | flat | mac    style:back2top:  enable: true  # Back to top in sidebar.  sidebar: false  # Scroll percent label in b2t button.  scrollpercent: false# Reading progress barreading_progress:  enable: false  # Available values: top | bottom  position: top  color: &quot;#37c6c0&quot;  height: 3px# Bookmark Supportbookmark:  enable: false  # Customize the color of the bookmark.  color: &quot;#222&quot;  # If auto, save the reading progress when closing the page or clicking the bookmark-icon.  # If manual, only save it by clicking the bookmark-icon.  save: auto# `Follow me on GitHub` banner in the top-right corner.github_banner:  enable: false  permalink: https://github.com/yourname  title: Follow me on GitHub# ---------------------------------------------------------------# Font Settings# See: https://theme-next.org/docs/theme-settings/#Fonts-Customization# ---------------------------------------------------------------# Find fonts on Google Fonts (https://www.google.com/fonts)# All fonts set here will have the following styles:#   light | light italic | normal | normal italic | bold | bold italic# Be aware that setting too much fonts will cause site running slowly# ---------------------------------------------------------------# To avoid space between header and sidebar in scheme Pisces / Gemini, Web Safe fonts are recommended for `global` (and `title`):# Arial | Tahoma | Helvetica | Times New Roman | Courier New | Verdana | Georgia | Palatino | Garamond | Comic Sans MS | Trebuchet MS# ---------------------------------------------------------------font:  enable: false  # Uri of fonts host, e.g. https://fonts.googleapis.com (Default).  host:  # Font options:  # `external: true` will load this font family from `host` above.  # `family: Times New Roman`. Without any quotes.  # `size: x.x`. Use `em` as unit. Default: 1 (16px)  # Global font settings used for all elements inside &lt;body&gt;.  global:    external: true    family: Lato    size:  # Font settings for site title (.site-title).  title:    external: true    family:    size:  # Font settings for headlines (&lt;h1&gt; to &lt;h6&gt;).  headings:    external: true    family:    size:  # Font settings for posts (.post-body).  posts:    external: true    family:  # Font settings for &lt;code&gt; and code blocks.  codes:    external: true    family:# ---------------------------------------------------------------# SEO Settings# ---------------------------------------------------------------# Disable Baidu transformation on mobile devices.disable_baidu_transformation: false# If true, site-subtitle will be added to index page.# Remember to set up your site-subtitle in Hexo `_config.yml` (e.g. subtitle: Subtitle)index_with_subtitle: false# Automatically add external URL with Base64 encrypt &amp; decrypt.exturl: false# Google Webmaster tools verification.# See: https://www.google.com/webmastersgoogle_site_verification:# Bing Webmaster tools verification.# See: https://www.bing.com/webmasterbing_site_verification:# Yandex Webmaster tools verification.# See: https://webmaster.yandex.ruyandex_site_verification:# Baidu Webmaster tools verification.# See: https://ziyuan.baidu.com/sitebaidu_site_verification:# Enable baidu push so that the blog will push the url to baidu automatically which is very helpful for SEO.baidu_push: false# ---------------------------------------------------------------# Third Party Plugins &amp; Services Settings# See: https://theme-next.org/docs/third-party-services/# More plugins: https://github.com/theme-next/awesome-next# You may need to install dependencies or set CDN URLs in `vendors`# There are two different CDN providers by default:#   - jsDelivr (cdn.jsdelivr.net), works everywhere even in China#   - CDNJS (cdnjs.cloudflare.com), provided by cloudflare# ---------------------------------------------------------------# Math Formulas Render Supportmath:  # Default (true) will load mathjax / katex script on demand.  # That is it only render those page which has `mathjax: true` in Front-matter.  # If you set it to false, it will load mathjax / katex srcipt EVERY PAGE.  per_page: true  # hexo-renderer-pandoc (or hexo-renderer-kramed) required for full MathJax support.  mathjax:    enable: true    # See: https://mhchem.github.io/MathJax-mhchem/    mhchem: false    #cdn: //cdn.jsdelivr.net/npm/mathjax@2.7.8/unpacked/MathJax.js?config=TeX-MML-AM_CHTML    cnd: https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js  #  per_page: true  #  cdn: //cdn.bootcss.com/mathjax/2.7.1/latest.js?config=TeX-AMS-MML_HTMLorMML  # hexo-renderer-markdown-it-plus (or hexo-renderer-markdown-it with markdown-it-katex plugin) required for full Katex support.  katex:    enable: false    # See: https://github.com/KaTeX/KaTeX/tree/master/contrib/copy-tex    copy_tex: false# Easily enable fast Ajax navigation on your website.# Dependencies: https://github.com/theme-next/theme-next-pjaxpjax: false# FancyBox is a tool that offers a nice and elegant way to add zooming functionality for images.# For more information: https://fancyapps.com/fancyboxfancybox: false# A JavaScript library for zooming images like Medium.# Do not enable both `fancybox` and `mediumzoom`.# For more information: https://github.com/francoischalifour/medium-zoommediumzoom: false# Vanilla JavaScript plugin for lazyloading images.# For more information: https://github.com/ApoorvSaxena/lozad.jslazyload: false# Pangu Support# For more information: https://github.com/vinta/pangu.jspangu: false# Quicklink Support# Do not enable both `pjax` and `quicklink`.# For more information: https://github.com/GoogleChromeLabs/quicklink# Front-matter (unsupport home archive).quicklink:  enable: false  # Home page and archive page can be controlled through home and archive options below.  # This configuration item is independent of `enable`.  home: false  archive: false  # Default (true) will initialize quicklink after the load event fires.  delay: true  # Custom a time in milliseconds by which the browser must execute prefetching.  timeout: 3000  # Default (true) will enable fetch() or falls back to XHR.  priority: true  # For more flexibility you can add some patterns (RegExp, Function, or Array) to ignores.  # See: https://github.com/GoogleChromeLabs/quicklink#custom-ignore-patterns  ignores:# ---------------------------------------------------------------# Comments Settings# See: https://theme-next.org/docs/third-party-services/comments# ---------------------------------------------------------------# Multiple Comment System Supportcomments:  # Available values: tabs | buttons  style: tabs  # Choose a comment system to be displayed by default.  # Available values: changyan | disqus | disqusjs | gitalk | livere | valine  active:  # Setting `true` means remembering the comment system selected by the visitor.  storage: true  # Lazyload all comment systems.  lazyload: false  # Modify texts or order for any navs, here are some examples.  nav:    #disqus:    #  text: Load Disqus    #  order: -1    #gitalk:    #  order: -2# Disqusdisqus:  enable: false  shortname:  count: true  #post_meta_order: 0# DisqusJS# Alternative Disqus - Render comment component using Disqus API.# Demo: https://suka.js.org/DisqusJS/# For more information: https://github.com/SukkaW/DisqusJSdisqusjs:  enable: false  # API Endpoint of Disqus API (https://disqus.com/api/).  # Leave api empty if you are able to connect to Disqus API. Otherwise you need a reverse proxy for it.  # For example:  # api: https://disqus.skk.moe/disqus/  api:  apikey: # Register new application from https://disqus.com/api/applications/  shortname: # See: https://disqus.com/admin/settings/general/# Changyanchangyan:  enable: false  appid:  appkey:  #post_meta_order: 0# Valine# For more information: https://valine.js.org, https://github.com/xCss/Valinevaline:  enable: false  appid: # Your leancloud application appid  appkey: # Your leancloud application appkey  notify: false # Mail notifier  verify: false # Verification code  placeholder: Just go go # Comment box placeholder  avatar: mm # Gravatar style  guest_info: nick,mail,link # Custom comment header  pageSize: 10 # Pagination size  language: # Language, available values: en, zh-cn  visitor: false # Article reading statistic  comment_count: true # If false, comment count will only be displayed in post page, not in home page  recordIP: false # Whether to record the commenter IP  serverURLs: # When the custom domain name is enabled, fill it in here (it will be detected automatically by default, no need to fill in)  #post_meta_order: 0# LiveRe comments system# You can get your uid from https://livere.com/insight/myCode (General web site)livere_uid: # &lt;your_uid&gt;# Gitalk# For more information: https://gitalk.github.io, https://github.com/gitalk/gitalkgitalk:  enable: false  github_id: # GitHub repo owner  repo: # Repository name to store issues  client_id: # GitHub Application Client ID  client_secret: # GitHub Application Client Secret  admin_user: # GitHub repo owner and collaborators, only these guys can initialize gitHub issues  distraction_free_mode: true # Facebook-like distraction free mode  # Gitalk&#x27;s display language depends on user&#x27;s browser or system environment  # If you want everyone visiting your site to see a uniform language, you can set a force language value  # Available values: en | es-ES | fr | ru | zh-CN | zh-TW  language:# ---------------------------------------------------------------# Post Widgets &amp; Content Sharing Services# See: https://theme-next.org/docs/third-party-services/post-widgets# ---------------------------------------------------------------# Star rating support to each article.# To get your ID visit https://widgetpack.comrating:  enable: false  id:     # &lt;app_id&gt;  color:  fc6423# AddThis Share. See: https://www.addthis.com# Go to https://www.addthis.com/dashboard to customize your tools.add_this_id:# ---------------------------------------------------------------# Statistics and Analytics# See: https://theme-next.org/docs/third-party-services/statistics-and-analytics# ---------------------------------------------------------------# Google Analyticsgoogle_analytics:  tracking_id: # &lt;app_id&gt;  # By default, NexT will load an external gtag.js script on your site.  # If you only need the pageview feature, set the following option to true to get a better performance.  only_pageview: false# Baidu Analyticsbaidu_analytics: # &lt;app_id&gt;# Growingio Analyticsgrowingio_analytics: # &lt;project_id&gt;# CNZZ countcnzz_siteid:# Show number of visitors of each article.# You can visit https://leancloud.cn to get AppID and AppKey.# AppID and AppKey are recommended to be the same as valine&#x27;s for counter compatibility.# Do not enable both `valine.visitor` and `leancloud_visitors`.leancloud_visitors:  enable: false  app_id: # &lt;your app id&gt;  app_key: # &lt;your app key&gt;  # Required for apps from CN region  server_url: # &lt;your server url&gt;  # Dependencies: https://github.com/theme-next/hexo-leancloud-counter-security  # If you don&#x27;t care about security in leancloud counter and just want to use it directly  # (without hexo-leancloud-counter-security plugin), set `security` to `false`.  security: true# Another tool to show number of visitors to each article.# Visit https://console.firebase.google.com/u/0/ to get apiKey and projectId.# Visit https://firebase.google.com/docs/firestore/ to get more information about firestore.firestore:  enable: false  collection: articles # Required, a string collection name to access firestore database  apiKey: # Required  projectId: # Required# Show Views / Visitors of the website / page with busuanzi.# Get more information on http://ibruce.info/2015/04/04/busuanzibusuanzi_count:  enable: false  total_visitors: true  total_visitors_icon: fa fa-user  total_views: true  total_views_icon: fa fa-eye  post_views: true  post_views_icon: fa fa-eye# ---------------------------------------------------------------# Search Services# See: https://theme-next.org/docs/third-party-services/search-services# ---------------------------------------------------------------# Algolia Search# For more information: https://www.algolia.comalgolia_search:  enable: false  hits:    per_page: 10  labels:    input_placeholder: Search for Posts    hits_empty: &quot;We didn&#x27;t find any results for the search: $&#123;query&#125;&quot;    hits_stats: &quot;$&#123;hits&#125; results found in $&#123;time&#125; ms&quot;# Local Search# Dependencies: https://github.com/theme-next/hexo-generator-searchdblocal_search:  enable: false  # If auto, trigger search by changing input.  # If manual, trigger search by pressing enter key or search button.  trigger: auto  # Show top n results per article, show all results by setting to -1  top_n_per_article: 1  # Unescape html strings to the readable one.  unescape: false  # Preload the search data when the page loads.  preload: false# Swiftype Search API Keyswiftype_key:# ---------------------------------------------------------------# Chat Services# See: https://theme-next.org/docs/third-party-services/chat-services# ---------------------------------------------------------------# Chatra Support# See: https://chatra.io# Dashboard: https://app.chatra.io/settings/generalchatra:  enable: false  async: true  id: # Visit Dashboard to get your ChatraID  #embed: # Unfinished experimental feature for developers. See: https://chatra.io/help/api/#injectto# Tidio Support# See: https://www.tidiochat.com# Dashboard: https://www.tidiochat.com/panel/dashboardtidio:  enable: false  key: # Public Key, get it from dashboard. See: https://www.tidiochat.com/panel/settings/developer# ---------------------------------------------------------------# Tags Settings# See: https://theme-next.org/docs/tag-plugins/# ---------------------------------------------------------------# Note tag (bs-callout)note:  # Note tag style values:  #  - simple    bs-callout old alert style. Default.  #  - modern    bs-callout new (v2-v3) alert style.  #  - flat      flat callout style with background, like on Mozilla or StackOverflow.  #  - disabled  disable all CSS styles import of note tag.  style: simple  icons: false  # Offset lighter of background in % for modern and flat styles (modern: -12 | 12; flat: -18 | 6).  # Offset also applied to label tag variables. This option can work with disabled note tag.  light_bg_offset: 0# Tabs tagtabs:  transition:    tabs: false    labels: true# PDF tag# NexT will try to load pdf files natively, if failed, pdf.js will be used.# So, you have to install the dependency of pdf.js if you want to use pdf tag and make it available to all browsers.# See: https://github.com/theme-next/theme-next-pdfpdf:  enable: false  # Default height  height: 500px# Mermaid tagmermaid:  enable: false  # Available themes: default | dark | forest | neutral  theme: forest# ---------------------------------------------------------------# Animation Settings# ---------------------------------------------------------------# Use velocity to animate everything.# For more information: http://velocityjs.orgmotion:  enable: true  async: false  transition:    # Transition variants:    # fadeIn | flipXIn | flipYIn | flipBounceXIn | flipBounceYIn    # swoopIn | whirlIn | shrinkIn | expandIn    # bounceIn | bounceUpIn | bounceDownIn | bounceLeftIn | bounceRightIn    # slideUpIn | slideDownIn | slideLeftIn | slideRightIn    # slideUpBigIn | slideDownBigIn | slideLeftBigIn | slideRightBigIn    # perspectiveUpIn | perspectiveDownIn | perspectiveLeftIn | perspectiveRightIn    post_block: fadeIn    post_header: slideDownIn    post_body: slideDownIn    coll_header: slideLeftIn    # Only for Pisces | Gemini.    sidebar: slideUpIn# Progress bar in the top during page loading.# Dependencies: https://github.com/theme-next/theme-next-pace# For more information: https://github.com/HubSpot/pacepace:  enable: false  # Themes list:  # big-counter | bounce | barber-shop | center-atom | center-circle | center-radar | center-simple  # corner-indicator | fill-left | flat-top | flash | loading-bar | mac-osx | material | minimal  theme: minimal# JavaScript 3D library.# Dependencies: https://github.com/theme-next/theme-next-threethree:  enable: false  three_waves: false  canvas_lines: false  canvas_sphere: false# Canvas-ribbon# Dependencies: https://github.com/theme-next/theme-next-canvas-ribbon# For more information: https://github.com/zproo/canvas-ribboncanvas_ribbon:  enable: false  size: 300 # The width of the ribbon  alpha: 0.6 # The transparency of the ribbon  zIndex: -1 # The display level of the ribbon#! ---------------------------------------------------------------#! DO NOT EDIT THE FOLLOWING SETTINGS#! UNLESS YOU KNOW WHAT YOU ARE DOING#! See: https://theme-next.org/docs/advanced-settings#! ---------------------------------------------------------------# Script Vendors. Set a CDN address for the vendor you want to customize.# Be aware that you would better use the same version as internal ones to avoid potential problems.# Remember to use the https protocol of CDN files when you enable https on your site.vendors:  # Internal path prefix.  _internal: lib  # Internal version: 3.1.0  # anime: //cdn.jsdelivr.net/npm/animejs@3.1.0/lib/anime.min.js  anime:  # Internal version: 5.13.0  # fontawesome: //cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css  # fontawesome: //cdnjs.cloudflare.com/ajax/libs/font-awesome/5.13.0/css/all.min.css  fontawesome:  # MathJax  # mathjax: //cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js  mathjax:  # KaTeX  # katex: //cdn.jsdelivr.net/npm/katex@0/dist/katex.min.css  # katex: //cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css  # copy_tex_js: //cdn.jsdelivr.net/npm/katex@0/dist/contrib/copy-tex.min.js  # copy_tex_css: //cdn.jsdelivr.net/npm/katex@0/dist/contrib/copy-tex.min.css  katex:  copy_tex_js:  copy_tex_css:  # Internal version: 0.2.8  # pjax: //cdn.jsdelivr.net/gh/theme-next/theme-next-pjax@0/pjax.min.js  pjax:  # FancyBox  # jquery: //cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js  # fancybox: //cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.js  # fancybox_css: //cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.css  jquery:  fancybox:  fancybox_css:  # Medium-zoom  # mediumzoom: //cdn.jsdelivr.net/npm/medium-zoom@1/dist/medium-zoom.min.js  mediumzoom:  # Lazyload  # lazyload: //cdn.jsdelivr.net/npm/lozad@1/dist/lozad.min.js  # lazyload: //cdnjs.cloudflare.com/ajax/libs/lozad.js/1.14.0/lozad.min.js  lazyload:  # Pangu  # pangu: //cdn.jsdelivr.net/npm/pangu@4/dist/browser/pangu.min.js  # pangu: //cdnjs.cloudflare.com/ajax/libs/pangu/4.0.7/pangu.min.js  pangu:  # Quicklink  # quicklink: //cdn.jsdelivr.net/npm/quicklink@1/dist/quicklink.umd.js  quicklink:  # DisqusJS  # disqusjs_js: //cdn.jsdelivr.net/npm/disqusjs@1/dist/disqus.js  # disqusjs_css: //cdn.jsdelivr.net/npm/disqusjs@1/dist/disqusjs.css  disqusjs_js:  disqusjs_css:  # Valine  # valine: //cdn.jsdelivr.net/npm/valine@1/dist/Valine.min.js  # valine: //cdnjs.cloudflare.com/ajax/libs/valine/1.3.10/Valine.min.js  valine:  # Gitalk  # gitalk_js: //cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js  # gitalk_css: //cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.css  gitalk_js:  gitalk_css:  # Algolia Search  # algolia_search: //cdn.jsdelivr.net/npm/algoliasearch@4/dist/algoliasearch-lite.umd.js  # instant_search: //cdn.jsdelivr.net/npm/instantsearch.js@4/dist/instantsearch.production.min.js  algolia_search:  instant_search:  # Mermaid  # mermaid: //cdn.jsdelivr.net/npm/mermaid@8/dist/mermaid.min.js  # mermaid: //cdnjs.cloudflare.com/ajax/libs/mermaid/8.4.8/mermaid.min.js  mermaid:  # Internal version: 1.2.1  # velocity: //cdn.jsdelivr.net/npm/velocity-animate@1/velocity.min.js  # velocity: //cdnjs.cloudflare.com/ajax/libs/velocity/1.2.1/velocity.min.js  # velocity_ui: //cdn.jsdelivr.net/npm/velocity-animate@1/velocity.ui.min.js  # velocity_ui: //cdnjs.cloudflare.com/ajax/libs/velocity/1.2.1/velocity.ui.min.js  velocity:  velocity_ui:  # Internal version: 1.0.2  # pace: //cdn.jsdelivr.net/npm/pace-js@1/pace.min.js  # pace: //cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/pace.min.js  # pace_css: //cdn.jsdelivr.net/npm/pace-js@1/themes/blue/pace-theme-minimal.css  # pace_css: //cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/themes/blue/pace-theme-minimal.min.css  pace:  pace_css:  # Internal version: 1.0.0  # three: //cdn.jsdelivr.net/gh/theme-next/theme-next-three@1/three.min.js  # three_waves: //cdn.jsdelivr.net/gh/theme-next/theme-next-three@1/three-waves.min.js  # canvas_lines: //cdn.jsdelivr.net/gh/theme-next/theme-next-three@1/canvas_lines.min.js  # canvas_sphere: //cdn.jsdelivr.net/gh/theme-next/theme-next-three@1/canvas_sphere.min.js  three:  three_waves:  canvas_lines:  canvas_sphere:  # Internal version: 1.0.0  # canvas_ribbon: //cdn.jsdelivr.net/gh/theme-next/theme-next-canvas-ribbon@1/canvas-ribbon.js  canvas_ribbon:# Assetscss: cssjs: jsimages: images\n超级坑跌折磨了我很久的东西，卸载原来的公式渲染marked，下载pandoc，换行用diplaylines：\n$$\\displaylines&#123;k_&#123;2&#125;=\\frac&#123;8&#125;&#123;5&#125;(1-2C)^&#123;2&#125;C^&#123;5&#125;[2C(y_&#123;2&#125;-1)-y_&#123;2&#125;+2]\\&#123;2C(4(y_&#123;2&#125;+1)C^&#123;4&#125;+(6y_&#123;2&#125;-4)C^&#123;3&#125;+ \\\\(26-22y_&#123;2&#125;)C^&#123;2&#125;+3(5y_&#123;2&#125;-8)C-3y_&#123;2&#125;+6)-3(1-2C)^&#123;2&#125;(2C(y_&#123;2&#125;-1)-y_&#123;2&#125;+2)\\log(\\frac&#123;1&#125;&#123;1-2C&#125;)\\&#125;^&#123;-1&#125;&#125;$$\n$$\\displaylines{k_{2}&#x3D;\\frac{8}{5}(1-2C)^{2}C^{5}[2C(y_{2}-1)-y_{2}+2]{2C(4(y_{2}+1)C^{4}+(6y_{2}-4)C^{3}+ \\(26-22y_{2})C^{2}+3(5y_{2}-8)C-3y_{2}+6)-3(1-2C)^{2}(2C(y_{2}-1)-y_{2}+2)\\log(\\frac{1}{1-2C})}^{-1}}$$鬼知道下次更新版本又有什么依赖问题会报错。。。\n使用hexo new post titlehexo cleanhexo ghexo d\n\n\n\n","categories":["linux"],"tags":["manjaro"]},{"title":"latex-tikz","url":"/2021/11/28/latex-tikz/","content":"latex下tikz作图\n\n在线编辑直接给两个网址tikzcd-editor,latex-preview.\n一些例子展示下tikz能做的图\n\\begin&#123;tikzpicture&#125;[domain=0:4]  \\draw[very thin,color=gray] (-0.1,-1.1) grid (3.9,3.9);  \\draw[-&gt;] (-0.2,0) -- (4.2,0) node[right] &#123;$x$&#125;;  \\draw[-&gt;] (0,-1.2) -- (0,4.2) node[above] &#123;$f(x)$&#125;;  \\draw[color=red]    plot (\\x,\\x)             node[right] &#123;$f(x) =x$&#125;;  \\draw[color=blue]   plot (\\x,&#123;sin(\\x r)&#125;)    node[right] &#123;$f(x) = \\sin x$&#125;;  \\draw[color=orange] plot (\\x,&#123;0.05*exp(\\x)&#125;) node[right] &#123;$f(x) = \\frac&#123;1&#125;&#123;20&#125; \\mathrm e^x$&#125;;\\end&#123;tikzpicture&#125;\n\n\\usetikzlibrary&#123;decorations.pathmorphing&#125;\\begin&#123;tikzpicture&#125;[line width=0.2mm,scale=1.0545]\\small\\tikzset&#123;&gt;=stealth&#125;\\tikzset&#123;snake it/.style=&#123;-&gt;,semithick,decoration=&#123;snake,amplitude=.3mm,segment length=2.5mm,post length=0.9mm&#125;,decorate&#125;&#125;\\def\\h&#123;3&#125;\\def\\d&#123;0.2&#125;\\def\\ww&#123;1.4&#125;\\def\\w&#123;1+\\ww&#125;\\def\\p&#123;1.5&#125;\\def\\r&#123;0.7&#125;\\coordinate[label=below:$A_1$] (A1) at (\\ww,\\p);\\coordinate[label=above:$B_1$] (B1) at (\\ww,\\p+\\h);\\coordinate[label=below:$A_2$] (A2) at (\\w,\\p);\\coordinate[label=above:$B_2$] (B2) at (\\w,\\p+\\h);\\coordinate[label=left:$C$] (C1) at (0,0);\\coordinate[label=left:$D$] (D) at (0,\\h);\\draw[fill=blue!14](A2)--(B2)-- ++(\\d,0)-- ++(0,-\\h)--cycle;\\draw[gray,thin](C1)-- +(\\w+\\d,0);\\draw[dashed,gray,fill=blue!5](A1)-- (B1)-- ++(\\d,0)-- ++(0,-\\h)-- cycle;\\draw[dashed,line width=0.14mm](A1)--(C1)--(D)--(B1);\\draw[snake it](C1)--(A2) node[pos=0.6,below] &#123;$c\\Delta t$&#125;;\\draw[-&gt;,semithick](\\ww,\\p+0.44*\\h)-- +(\\w-\\ww,0) node[pos=0.6,above] &#123;$v\\Delta t$&#125;;\\draw[snake it](D)--(B2);\\draw[thin](\\r,0) arc (0:atan2(\\p,\\w):\\r) node[midway,right,yshift=0.06cm] &#123;$\\theta$&#125;;\\draw[opacity=0](-0.40,-0.14)-- ++(0,5.06);\\end&#123;tikzpicture&#125;\n\n\\begin&#123;tikzcd&#125; T\\arrow[drr, bend left, &quot;x&quot;]\\arrow[ddr, bend right, &quot;y&quot;]\\arrow[dr, dotted, &quot;&#123;(x,y)&#125;&quot;] &amp; &amp; \\\\&amp; X \\times_Z Y \\arrow[r, &quot;p&quot;] \\arrow[d, &quot;q&quot;]&amp; X \\arrow[d, &quot;f&quot;] \\\\&amp; Y \\arrow[r, &quot;g&quot;]&amp; Z\\end&#123;tikzcd&#125;\n甚至！\n\\usetikzlibrary&#123;positioning, arrows.meta&#125;\\tikzset&#123;  rect1/.style = &#123;    shape = rectangle,    draw = green,    text width = 3cm,    align = center,    minimum height = 1cm,  &#125;&#125;\\tikzset&#123;  arrow1/.style = &#123;    draw = purple, thick, -&#123;Latex[length = 4mm, width = 1.5mm]&#125;,  &#125;&#125;\\tikzset&#123;  arrow2/.style = &#123;    draw = purple, thick, &#123;Latex[length = 4mm, width = 1.5mm]&#125;-&#123;Latex[length = 4mm, width = 1.5mm]&#125;,  &#125;&#125;\\begin&#123;center&#125;  \\begin&#123;tikzpicture&#125;    \\node[rect1, fill = green!60!white](lexical)&#123;lexical analysis&#125;;    \\node[rect1, fill = green!40!white, below = of lexical](Gramma)&#123;Gramma analysis&#125;;    \\node[rect1, fill = green!20!white, below = of Gramma, text width = 5cm](Semantic middle)&#123;Semantic Analysis、Intermediate representation&#125;;    \\node[rect1, fill = green!60!black, below = of Semantic middle](optimization)&#123;\\color&#123;white&#125;Code optimization&#125;;    \\node[rect1, fill = green!30!black, below = of optimization](generate)&#123;\\color&#123;white&#125;Code generation&#125;;    \\node[rectangle, fill = red!20!white, draw = red, text width = 2.0cm, minimum height = 4cm, align = center, left = 2cm of Semantic middle](Symbol)&#123;Symbol table management&#125;;    \\node[rectangle, fill = blue!20!white, draw = blue, text width = 2.0cm, minimum height = 4cm, align = center, right = 2cm of Semantic middle](Error handling)&#123;Error handling&#125;;    \\draw[arrow1](0, 50pt)node[right, yshift = -15pt]&#123;Input source program&#125; -- (lexical);    \\draw[arrow1](lexical) -- node[right]&#123;Word flow&#125;(Gramma);    \\draw[arrow1](Gramma) -- node[right]&#123;grammar&#125;(Semantic middle);    \\draw[arrow1](Semantic middle) -- node[right]&#123;Middle representation&#125;(optimization);    \\draw[arrow1](optimization) -- node[right]&#123;Middle representation after optimization&#125;(generate);    \\draw[arrow1](generate) -- node[right, yshift = 5pt, xshift = 5pt]&#123;Object code&#125;++(0, -50pt);    \\draw[arrow2](Symbol) -- (lexical.west);    \\draw[arrow2](Symbol) -- (Gramma.west);    \\draw[arrow2](Symbol) -- (Semantic middle);    \\draw[arrow2](Symbol) -- (optimization.west);    \\draw[arrow2](Symbol) -- (generate.west);    \\draw[arrow2](Error handling) -- (lexical.east);    \\draw[arrow2](Error handling) -- (Gramma.east);    \\draw[arrow2](Error handling) -- (Semantic middle);    \\draw[arrow2](Error handling) -- (optimization.east);    \\draw[arrow2](Error handling) -- (generate.east);    \\draw[thick, dashed, draw = purple](-125pt, 27pt)node[below right]&#123;Compiler front end&#125; -- (125pt, 27pt) -- (125pt, -250pt) -- (-125pt, -250pt)node[above right]&#123;Compiler backend&#125; -- (-125pt, 27pt);    \\draw[thick, dashed, draw = purple](-125pt, -135pt) -- (125pt, -135pt);  \\end&#123;tikzpicture&#125;  \\\\ fig.1 Compiler structure diagram\\end&#123;center&#125;\n\n\\usetikzlibrary&#123;positioning, arrows.meta, calc&#125;\\tikzset&#123;  arrow1/.style = &#123;    draw = purple, thick, -&#123;Latex[length = 4mm, width = 1.5mm]&#125;,  &#125;&#125;\\tikzset&#123;  nonterminal/.style = &#123;    rectangle,    align = center,    minimum size = 6mm,    very thick,    draw = red!50!black!50,    top color = white,    bottom color = red!50!black!20,  &#125;&#125;\\tikzset&#123;  terminal/.style = &#123;    rectangle,    align = center,    minimum size = 6mm,    rounded corners = 3mm,    very thick,    draw = black!50,    top color = white,    bottom color = black!20,  &#125;&#125;\\hspace&#123;-3cm&#125;&#123;\\begin&#123;minipage&#125;&#123;15.4cm&#125;  \\begin&#123;tikzpicture&#125;[node distance = 0.7cm]    \\node[terminal](function)&#123;FUNCTION&#125;;    \\node[nonterminal, right = of function](name1)&#123;Function name&#125;;    \\node[terminal, right = of name1](left)&#123;(&#125;;    \\node[terminal, right = of left](var)&#123;VAR&#125;;    \\node[nonterminal, right = of var](para)&#123;Formal parameters&#125;;    \\node[terminal, right = of para](colon1)&#123;:&#125;;    \\node[nonterminal, right = of colon1](type1)&#123;Type name&#125;;    \\node[terminal, right = of type1](right)&#123;)&#125;;    \\node[terminal, right = of right](colon2)&#123;:&#125;;    \\node[nonterminal, right = of colon2](type2)&#123;Type name&#125;;    \\node[terminal, right = of type2](semicolon1)&#123;;&#125;;    \\node[terminal, below = of para](semicolon2)&#123;;&#125;;% ----------------------------------------------------------    \\draw[arrow1](function)--(name1);    \\draw[arrow1](name1)--(left);    \\draw[arrow1](left)--(var);    \\draw[arrow1](var)--(para);    \\draw[arrow1](para)--(colon1);    \\draw[arrow1](colon1)--(type1);    \\draw[arrow1](type1)--(right);    \\draw[arrow1](right)--(colon2);    \\draw[arrow1](colon2)--(type2);    \\draw[arrow1](type2)--(semicolon1);    \\draw[arrow1]($ (var.west)+(-3mm, 0) $)--++(0, 6mm)-|($ (var.east)+(3mm, 0) $);    \\draw[arrow1]($ (type1.east)+(3mm, 0) $)|-(semicolon2);    \\draw[arrow1](semicolon2)-|($ (var.west)-(3mm, 0) $);    \\draw[arrow1]($ (name1.east)+(3mm, 0) $)--++(0, -20mm)-|($ (right.east)+(3mm, 0) $);% ----------------------------------------------------------    \\node[nonterminal, below = 2.7cm of function, xshift = 1cm](description)&#123;Description section&#125;;    \\node[terminal, right = of description](begin)&#123;BEGIN&#125;;    \\node[nonterminal, right = of begin, text width = 1.6cm](statement)&#123;Statement&#125;;    \\node[terminal, right = of statement](semicolon3)&#123;;&#125;;    \\node[terminal, right = of semicolon3, text width = 1.6cm](end)&#123;END&#125;;    \\node[terminal, right = of end](semicolon4)&#123;;&#125;;% ----------------------------------------------------------    \\draw[arrow1](description)--(begin);    \\draw[arrow1](begin)--(statement);    \\draw[arrow1](statement)--(semicolon3);    \\draw[arrow1](semicolon3)--(end);    \\draw[arrow1](end)--(semicolon4);    \\draw[arrow1](semicolon4)--++(30pt, 0);    \\draw[arrow1](semicolon1)--++(0, -2.5cm)-|(description);    \\draw[arrow1]($ (semicolon3.east)+(3mm, 0) $)--++(0, -6mm)-|($ (begin.east)+(3mm, 0) $);  \\end&#123;tikzpicture&#125;\\end&#123;minipage&#125;\n\n结尾画简单的流程图，函数图和费曼图没什么问题，但是数据做图还是老老实实用作图软件.\n","tags":["latex"]},{"title":"manjaro的安装与配置","url":"/2021/06/28/manjaro/","content":"由于经常用到linux系统，相比之下manjaro深得人心，避免以后换电脑又到处折腾，在这里记录一下自己的配置和走过的弯路。\n\n\nmanjaro安装manjaro.org/download/\nrufus制作启动盘，安装没什么好说的，一直下一步就行了，分区root得多给一些空间，网上很多说20g就够了，当用包管理器下载爽了就发现一会就满了，相比之下home目录根本用不了那么大，500G硬盘建议给root150G的空间\n换源和基本安装sudo pacman-mirrors -i -c China -m rank\n选择延迟最低的一个源即可\nsudo pacman -Syusudo pacman -Syy\n更新一下\nsudo pacman -S yayyay -S base-devel\n打包工具下载\n中文输入法sudo pacman -S fcitx-imsudo pacman -S fcitx-configtoolsudo pacman -S fcitx-googlepinyin\n下载vim，打开~&#x2F;.xprofile\nexport GTK_IM_MODULE=fcitxexport QT_IM_MODULE=fcitxexport XMODIFIERS=&quot;@im=fcitx&quot;\n写入重启就能输入中文了\nzsh和ohmyzshmanjaro自带zsh，omz因为某些原因下载不了，我们要进入以下网址：https://www.ipaddress.com/ 输入githubusercontent.com查询ip，修改host\nsudo vim /etc/hosts\n在里面加入查询到的ip\nxxx.xxx.xx.xxx raw.githubusercontent.com\n终端输入\nsh -c &quot;$(curl -fsSL https://raw.github.com/robbyrussell/oh-my-zsh/master/tools/install.sh)&quot;\n安装语法高亮和自动补全插件\ngit clone https://github.com/zsh-users/zsh-autosuggestions $ZSH_CUSTOM/plugins/zsh-autosuggestionsgit clone https://github.com/zsh-users/zsh-syntax-highlighting.git $ZSH_CUSTOM/plugins/zsh-syntax-highlighting\n打开.zshrc，导入插件，最后source一下\n软件下载sublime\nyay -S sublime-text-3\nedge浏览器\nyay -S microsoft-edge\n安装完zsh后tab补全就知道下载哪个了。\nvim 配置下载插件管理器\ngit clone https://github.com/VundleVim/Vundle.vim.git ~/.vim/bundle/Vundle.vim\n到bundle目录下，下载ycm插件\ngit clone https://github.com/Valloric/YouCompleteMe.git\n下载打包工具\nyay -S cmakeyay -S go\ngit submodule update --init --recursive\n到Youcompleteme目录下\nsudo ./install.py --all\n等待编译完成,可能会遇到的错误\nexport GOPROXY=http://goproxy.io(&quot;go 模块设置代理&quot;)sudo pacman -S openjdk-11-jdk （安装java）\n最后copy以下vim配置\nset nocompatiblefiletype onsyntax enable set nuset rtp+=~/.vim/bundle/Vundle.vimcall vundle#begin()&quot; 这里根据自己需要的插件来设置，以下是我的配置 &quot;&quot; YouCompleteMe:语句补全插件set runtimepath+=~/.vim/bundle/YouCompleteMeautocmd InsertLeave * if pumvisible() == 0|pclose|endif &quot;离开插入模式后自动关闭预览窗口&quot;let g:ycm_collect_identifiers_from_tags_files = 1           &quot; 开启 YCM基于标签引擎let g:ycm_collect_identifiers_from_comments_and_strings = 1 &quot; 注释与字符串中的内容也用于补全let g:syntastic_ignore_files=[&quot;.*\\.py$&quot;]let g:ycm_seed_identifiers_with_syntax = 1                  &quot; 语法关键字补全let g:ycm_complete_in_comments = 1let g:ycm_confirm_extra_conf = 0                            &quot; 关闭加载.ycm_extra_conf.py提示let g:ycm_key_list_select_completion = [&#x27;&lt;c-n&gt;&#x27;, &#x27;&lt;Down&gt;&#x27;]  &quot; 映射按键,没有这个会拦截掉tab, 导致其他插件的tab不能用.let g:ycm_key_list_previous_completion = [&#x27;&lt;c-p&gt;&#x27;, &#x27;&lt;Up&gt;&#x27;]let g:ycm_complete_in_comments = 1                          &quot; 在注释输入中也能补全let g:ycm_complete_in_strings = 1                           &quot; 在字符串输入中也能补全let g:ycm_collect_identifiers_from_comments_and_strings = 1 &quot; 注释和字符串中的文字也会被收入补全let g:ycm_global_ycm_extra_conf=&#x27;~/.vim/bundle/YouCompleteMe/third_party/ycmd/cpp/ycm/.ycm_extra_conf.py&#x27;let g:ycm_show_diagnostics_ui = 0                           &quot; 禁用语法检查inoremap &lt;expr&gt; &lt;CR&gt; pumvisible() ? &quot;\\&lt;C-y&gt;&quot; : &quot;\\&lt;CR&gt;&quot;             &quot; 回车即选中当前项nnoremap &lt;c-j&gt; :YcmCompleter GoToDefinitionElseDeclaration&lt;CR&gt;     &quot; 跳转到定义处let g:ycm_min_num_of_chars_for_completion=2                 &quot; 从第2个键入字符就开始罗列匹配项&quot;&quot; github 仓库中的插件 &quot;Plugin &#x27;VundleVim/Vundle.vim&#x27; Plugin &#x27;vim-airline/vim-airline&#x27;&quot;vim-airline配置:优化vim界面&quot;&quot;let g:airline#extensions#tabline#enabled = 1&quot; airline设置&quot; 显示颜色set t_Co=256set laststatus=2&quot; 使用powerline打过补丁的字体let g:airline_powerline_fonts = 1&quot; 开启tablinelet g:airline#extensions#tabline#enabled = 1&quot; tabline中当前buffer两端的分隔字符let g:airline#extensions#tabline#left_sep = &#x27; &#x27;&quot; tabline中未激活buffer两端的分隔字符let g:airline#extensions#tabline#left_alt_sep = &#x27; &#x27;&quot; tabline中buffer显示编号let g:airline#extensions#tabline#buffer_nr_show = 1&quot; 映射切换buffer的键位nnoremap [b :bp&lt;CR&gt;nnoremap ]b :bn&lt;CR&gt;&quot; 映射&lt;leader&gt;num到num buffermap &lt;leader&gt;1 :b 1&lt;CR&gt;map &lt;leader&gt;2 :b 2&lt;CR&gt;map &lt;leader&gt;3 :b 3&lt;CR&gt;map &lt;leader&gt;4 :b 4&lt;CR&gt;map &lt;leader&gt;5 :b 5&lt;CR&gt;map &lt;leader&gt;6 :b 6&lt;CR&gt;map &lt;leader&gt;7 :b 7&lt;CR&gt;map &lt;leader&gt;8 :b 8&lt;CR&gt;map &lt;leader&gt;9 :b 9&lt;CR&gt;&quot; vim-scripts 中的插件 &quot;Plugin &#x27;taglist.vim&#x27;&quot;ctags 配置:F3快捷键显示程序中的各种tags，包括变量和函数等。map &lt;F3&gt; :TlistToggle&lt;CR&gt;let Tlist_Use_Right_Window=1let Tlist_Show_One_File=1let Tlist_Exit_OnlyWindow=1let Tlist_WinWidt=25 Plugin &#x27;The-NERD-tree&#x27;&quot;NERDTree 配置:F2快捷键显示当前目录树map &lt;F2&gt; :NERDTreeToggle&lt;CR&gt;let NERDTreeWinSize=25  Plugin &#x27;indentLine.vim&#x27;Plugin &#x27;delimitMate.vim&#x27; &quot; 非 github 仓库的插件&quot;&quot; Plugin &#x27;git://git.wincent.com/command-t.git&#x27;&quot; 本地仓库的插件 &quot; call vundle#end()set fileencodings=ucs-bom,utf-8,utf-16,gbk,big5,gb18030,shift-jis,euc-jp,euc-kr,latin1set fileencoding=utf-8let s:extfname=expand(&quot;%:e&quot;)if s:extfname==?&quot;f90&quot;        let fortran_free_source=1        unlet! fortran_fixed_sourceelse        let fortran_fixed_source=1        unlet! fortran_free_sourceendiffiletype plugin indent onlet g:UltiSnipsExpandTrigger=&#x27;&lt;tab&gt;&#x27;let g:UltiSnipsJumpForwardTrigger=&#x27;&lt;tab&gt;&#x27;let g:UltiSnipsJumpBackwardTrigger=&#x27;&lt;s-tab&gt;&#x27;let fortran_more_precise=1let fortran_do_enddo=1let fortran_have_tabs=1let fortran_fold=1let fortran_fold_conditionals=1set foldmethod=syntax&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;新文件标题&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;新建.c,.h,.sh,.java文件，自动插入文件头 autocmd BufNewFile *.cpp,*.[ch],*.sh,*.java exec &quot;:call SetTitle()&quot; &quot;&quot;定义函数SetTitle，自动插入文件头 func SetTitle()         &quot;如果文件类型为.sh文件         if &amp;filetype == &#x27;sh&#x27;                 call setline(1, &quot;##########################################################################&quot;)                 call append(line(&quot;.&quot;), &quot;# File Name: &quot;.expand(&quot;%&quot;))                 call append(line(&quot;.&quot;)+1, &quot;# Author: amoscykl&quot;)                 call append(line(&quot;.&quot;)+2, &quot;# mail: amoscykl980629@163.com&quot;)                 call append(line(&quot;.&quot;)+3, &quot;# Created Time: &quot;.strftime(&quot;%c&quot;))                 call append(line(&quot;.&quot;)+4, &quot;#########################################################################&quot;)                 call append(line(&quot;.&quot;)+5, &quot;#!/bin/zsh&quot;)                call append(line(&quot;.&quot;)+6, &quot;PATH=/home/edison/bin:/home/edison/.local/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin:/work/tools/gcc-3.4.5-glibc-2.3.6/bin&quot;)                call append(line(&quot;.&quot;)+7, &quot;export PATH&quot;)                call append(line(&quot;.&quot;)+8, &quot;&quot;)        else                 call setline(1, &quot;/*************************************************************************&quot;)                 call append(line(&quot;.&quot;), &quot;        &gt; File Name: &quot;.expand(&quot;%&quot;))                 call append(line(&quot;.&quot;)+1, &quot;      &gt; Author: amoscykl&quot;)                 call append(line(&quot;.&quot;)+2, &quot;      &gt; Mail: amoscykl@163.com &quot;)                 call append(line(&quot;.&quot;)+3, &quot;      &gt; Created Time: &quot;.strftime(&quot;%c&quot;))                 call append(line(&quot;.&quot;)+4, &quot; ************************************************************************/&quot;)                 call append(line(&quot;.&quot;)+5, &quot;&quot;)        endif        if &amp;filetype == &#x27;cpp&#x27;                call append(line(&quot;.&quot;)+6, &quot;#include&lt;iostream&gt;&quot;)        call append(line(&quot;.&quot;)+7, &quot;using namespace std;&quot;)                call append(line(&quot;.&quot;)+8, &quot;&quot;)        endif        if &amp;filetype == &#x27;c&#x27;                call append(line(&quot;.&quot;)+6, &quot;#include&lt;stdio.h&gt;&quot;)                call append(line(&quot;.&quot;)+7, &quot;&quot;)        endif        &quot;       if &amp;filetype == &#x27;java&#x27;        &quot;               call append(line(&quot;.&quot;)+6,&quot;public class &quot;.expand(&quot;%&quot;))        &quot;               call append(line(&quot;.&quot;)+7,&quot;&quot;)        &quot;       endif        &quot;新建文件后，自动定位到文件末尾        autocmd BufNewFile * normal Gendfunc &quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;键盘命令&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot; nmap &lt;leader&gt;w :w!&lt;cr&gt;nmap &lt;leader&gt;f :find&lt;cr&gt; &quot; 映射全选+复制 ctrl+amap &lt;C-A&gt; ggVGYmap! &lt;C-A&gt; &lt;Esc&gt;ggVGYmap &lt;F12&gt; gg=G&quot; 选中状态下 Ctrl+c 复制vmap &lt;C-c&gt; &quot;+y   &quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;实用设置&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot; 设置当文件被改动时自动载入set autoread&quot; quickfix模式autocmd FileType c,cpp map &lt;buffer&gt; &lt;leader&gt;&lt;space&gt; :w&lt;cr&gt;:make&lt;cr&gt;&quot;代码补全 set completeopt=preview,menu &quot;允许插件  filetype plugin on&quot;共享剪贴板  set clipboard=unnamed &quot;从不备份  set nobackup&quot;make 运行:set makeprg=g++\\ -Wall\\ \\ %&quot;自动保存set autowriteset ruler                   &quot; 打开状态栏标尺set cursorline              &quot; 突出显示当前行set magic                   &quot; 设置魔术set guioptions-=T           &quot; 隐藏工具栏set guioptions-=m           &quot; 隐藏菜单栏&quot;set statusline=\\ %&lt;%F[%1*%M%*%n%R%H]%=\\ %y\\ %0(%&#123;&amp;fileformat&#125;\\ %&#123;&amp;encoding&#125;\\ %c:%l/%L%)\\&quot; 设置在状态行显示的信息set foldcolumn=0set foldmethod=indent set foldlevel=3 set foldenable              &quot; 开始折叠&quot; 不要使用vi的键盘模式，而是vim自己的set nocompatible&quot; 语法高亮set syntax=on&quot; 去掉输入错误的提示声音set noeb&quot; 在处理未保存或只读文件的时候，弹出确认set confirm&quot; 自动缩进set autoindentset cindent&quot; Tab键的宽度set tabstop=4&quot; 统一缩进为4set softtabstop=4set shiftwidth=4&quot; 不要用空格代替制表符set noexpandtab&quot; 在行和段开始处使用制表符set smarttab&quot; 显示行号set number&quot; 历史记录数set history=1000&quot;禁止生成临时文件set nobackupset noswapfile&quot;搜索忽略大小写set ignorecase&quot;搜索逐字符高亮set hlsearchset incsearch&quot;行内替换set gdefault&quot;编码设置set enc=utf-8set fencs=utf-8,ucs-bom,shift-jis,gb18030,gbk,gb2312,cp936&quot;语言设置set langmenu=zh_CN.UTF-8set helplang=cn&quot; 我的状态行显示的内容（包括文件类型和解码）set statusline=%F%m%r%h%w\\ [FORMAT=%&#123;&amp;ff&#125;]\\ [TYPE=%Y]\\ [POS=%l,%v][%p%%]\\ %&#123;strftime(\\&quot;%d/%m/%y\\ -\\ %H:%M\\&quot;)&#125;set statusline=[%F]%y%r%m%*%=[Line:%l/%L,Column:%c][%p%%]&quot; 总是显示状态行set laststatus=2&quot; 命令行（在状态行下）的高度，默认为1，这里是2set cmdheight=2&quot; 侦测文件类型filetype on&quot; 载入文件类型插件filetype plugin on&quot; 为特定文件类型载入相关缩进文件filetype indent on&quot; 保存全局变量set viminfo+=!&quot; 带有如下符号的单词不要被换行分割set iskeyword+=_,$,@,%,#,-&quot; 字符间插入的像素行数目set linespace=0&quot; 增强模式中的命令行自动完成操作set wildmenu&quot; 使回格键（backspace）正常处理indent, eol, start等set backspace=2&quot; 允许backspace和光标键跨越行边界set whichwrap+=&lt;,&gt;,h,l&quot; 可以在buffer的任何地方使用鼠标（类似office中在工作区双击鼠标定位）set mouse=aset selection=exclusiveset selectmode=mouse,key&quot; 通过使用: commands命令，告诉我们文件的哪一行被改变过set report=0&quot; 在被分割的窗口间显示空白，便于阅读set fillchars=vert:\\ ,stl:\\ ,stlnc:\\&quot; 高亮显示匹配的括号set showmatch&quot; 匹配括号高亮的时间（单位是十分之一秒）set matchtime=1&quot; 光标移动到buffer的顶部和底部时保持3行距离set scrolloff=3&quot; 为C程序提供自动缩进set smartindent&quot; 高亮显示普通txt文件（需要txt.vim脚本） au BufRead,BufNewFile *  setfiletype txt&quot;自动补全:inoremap ( ()&lt;ESC&gt;i:inoremap ) &lt;c-r&gt;=ClosePair(&#x27;)&#x27;)&lt;CR&gt;&quot;:inoremap &#123; &#123;&lt;CR&gt;&#125;&lt;ESC&gt;O&quot;:inoremap &#125; &lt;c-r&gt;=ClosePair(&#x27;&#125;&#x27;)&lt;CR&gt;:inoremap [ []&lt;ESC&gt;i:inoremap ] &lt;c-r&gt;=ClosePair(&#x27;]&#x27;)&lt;CR&gt;:inoremap &quot; &quot;&quot;&lt;ESC&gt;i:inoremap &#x27; &#x27;&#x27;&lt;ESC&gt;ifunction! ClosePair(char)        if getline(&#x27;.&#x27;)[col(&#x27;.&#x27;) - 1] == a:char                return &quot;\\&lt;Right&gt;&quot;        else                return a:char        endifendfunctionfiletype plugin indent on &quot;打开文件类型检测, 加了这句才可以用智能补全set completeopt=longest,menu\ntaglist插件需要ctags，没有要先下载，最后打开vim\nPluginInstall\n等安装完成，失败多试几次我加了fortran语法，F2打开目录，F3显示函数，zc自动折叠函数\nclash 及开机自启动下载clash\nsudo pacman -S clash\n将下面写入到 &#x2F;etc&#x2F;systemd&#x2F;system&#x2F;clash.service\n[Unit]Description=Clash serviceAfter=network.target[Service]Type=simpleUser=marigoldExecStart=/usr/bin/clash  Restart=on-failureRestartPreventExitStatus=23[Install]WantedBy=multi-user.target\n运行clash，生成配置文件到~&#x2F;config&#x2F;clash&#x2F;,包含config.yaml和country.mmdb\n#开机启动\nsystemctl enable clash.service\n关闭\nsystemctl disable clash.service\n查看\nsystemctl status clash.service\n```\n## 其他的软件自行下载\n![](screen.png)\n\n","categories":["linux"],"tags":["manjaro","vim"]},{"title":"tidal_deformability","url":"/2021/11/22/tidal-deformability/","content":"Tidal deformability of neutron star\n\nvarious tidal love number of compact starWhen spherical star placed in a static external quadrupolar tidal field $\\varepsilon_{ij}$ then the star will be deformed and quadrupole deformation will be the leading order perturbation. Such a deformation is defined as the radio of the mass quadrupole moment of a star $Q_{ij}$ to the external tidal field $\\varepsilon_{ij}$:$$\\begin{equation}\\lambda&#x3D;\\frac{Q_{ij} } {\\varepsilon_{ij} }\\end{equation}$$Specifically, the observable of the tidal deformability parameter $\\lambda$ depends on the EOS via the neutron star(NS) radius and a dimensionless quantity $k_{2}$, called the Love number and is given by the relation:$$\\begin{equation}\\lambda&#x3D;\\frac{2}{3}k_{2}R^{5},\\end{equation}$$and the dimensionless tidal-deformability($\\Lambda$) is related with the compactness parameter $C&#x3D;M&#x2F;R$ as:$$\\begin{equation}\\lambda&#x3D;\\frac{2 k_{2} } {3 C^{5} },\\end{equation}$$where R is the radius of the star in isolation. We have to get $k_{2}$ for the calculation of the deformability parameter $\\lambda$.To estimate the love number $k_{l}(l&#x3D;2,3,4)$, along with the evaluation of the TOV equations, we have to compute $y&#x3D;y_{l}(R)$ with initial boundary condition $y(0)&#x3D;l$ from the following first order different equation iteratively:$$\\begin{equation}r\\frac{dy(r)}{dr}+y(r)^{2}+y(r)F(r)+r^{2}Q(r)&#x3D;0,\\end{equation}$$with,$$\\begin{equation}F(r)&#x3D;\\frac{r-4\\pi r^{3}[\\varepsilon(r)-P(r)]}{r-2M(r)},\\end{equation}$$$$\\begin{equation}Q(r)&#x3D;\\frac{4\\pi(5\\varepsilon(r)+9P(r)+\\frac{\\varepsilon(r)+P(r)}{\\partial P(r)&#x2F;\\varepsilon(r)}-\\frac{l(l+1)}{4\\pi r^{2}})}{r-2M(r)}-4[\\frac{M(r)+4\\pi r^{3}P(r)}{r^{2}(1-2M(r)&#x2F;r)}]^{2}.\\end{equation}$$once,we know the value of $y&#x3D;y_{l}(R)$, the love numbers $k_{l}$ are found from the following expression:$$\\displaylines{k_{2}&#x3D;\\frac{8}{5}(1-2C)^{2}C^{5}[2C(y_{2}-1)-y_{2}+2]{2C(4(y_{2}+1)C^{4}+(6y_{2}-4)C^{3}+ \\(26-22y_{2})C^{2}+3(5y_{2}-8)C-3y_{2}+6)-3(1-2C)^{2}(2C(y_{2}-1)-y_{2}+2)\\log(\\frac{1}{1-2C})}^{-1}}$$and $k_{3}, k_{4}$ ref from Relativistic tidal properties of neutron stars.As we have emphasized earlier, the dimensionless love number $k_{l}(l&#x3D;2,3,4)$ is an important quantity to measure the internal structure of the constituent body. These quantities directly enter into the gravitational wave phase of inspiralling binary neutron star and extract the information of the EOS. Notice that equation contain an overall factor $(1-2C)^{2}$, which tends to zero when the compactness approaches the compactness of the black hole $C^{BH}&#x3D;1&#x2F;2$. Also, it is to be pointed out that the presence of multiplication order factor $C$ with $(1-2C)^{2}$ in the expression of $k_{l}$ that the value of the love number of a black hole simply becomes zero $k_{l}^{BH}&#x3D;0$.\nsurficial love numberWe calculate the surficial love number $h_{l}$ which describes the deformation of the body’s surface in a multipole expansion. Damour and Nagar have given the surficial love number (also known as shape love number)$h_{l}$ for the coordinate displacement $\\delta R$ of the body’s surface under the external tidal forcesurfical love number and Landry and Poisson have proposed the defination of Newtonian love number is terms of a curvature perturbation $\\delta R$ instead of a surface displacement $\\delta R$Newtonian love number. For a perfect fluid, the relation between the surficial love number $h_{l}$ and tidal love number $k_{l}$ is given as :$$\\begin{equation}h_{l}&#x3D;\\Gamma_{1}+2\\Gamma_{2}k_{l}\\end{equation}$$$$\\begin{equation}\\Gamma_{1}&#x3D;\\frac{l+1}{l-1}(1-C)F(-l,-l,-2l;2C)-\\frac{2}{l-1}F(-l,-l,-1,-2l;2C)\\end{equation}$$$$\\begin{equation}\\Gamma_{2}&#x3D;\\frac{1}{l+2}(1-C)F(l+1,l+1,2l+2;2C)+\\frac{2}{l+2}F(l+1,l,2l+2;2C).\\end{equation}$$where $F(a,b,c;d)$ is the hypergeometric function .\nmagnetic tidal love numberThe quadrupolar case (l&#x3D;2):$$\\displaylines{j_{2}&#x3D;{96C^{5}(2C-1)(y_{2}-3)}{5(2C(12(y_{2}+1)C^{4} \\+2(y_{2}-3)C^{3}+2(y_{2}-3)C^{2}+3(y_{2}-3)C- \\3y_{2}+9)+3(2C-1)(y_{2}-3)\\log(1-2C))}^{-1}}$$\n","categories":["公式推导"],"tags":["General_Relativity","neutron star"]},{"title":"windows_scoop","url":"/2021/11/23/windows-scoop/","content":"Windows ternimal 配置\n\nscoop安装windows terminal直接去microsoft store下载\n安装powershell7powershell7选择win-x64-msi安装\nscoop获取权限\nSet-ExecutionPolicy -ExecutionPolicy RemoteSigned -Scope CurrentUser\n下载\niwr -useb get.scoop.sh | iex\n常用命令\nscoop update #更新scoop config set proxy 127.0.0.1:7890 #设置代理scoop config rm proxy #删除代理# bucket 源scoop bucket add main # 默认scoop bucket add extras # 推荐scoop bucket add versionsscoop bucket add nightliesscoop bucket add nirsoftscoop bucket add phpscoop bucket add nerd-fontsscoop bucket add nonportablescoop bucket add javascoop bucket add gamesscoop bucket add jetbrains # 推荐# 常用软件scoop install aria2scoop install vimscoop install pythonscoop install goscoop install vscodescoop install sublime-textscoop install wget\noh my posh 安装安装\nSet-ExecutionPolicy BypassInstall-Module oh-my-posh -Scope CurrentUserInstall-Module posh-git -Scope CurrentUser\n查看主题\n$PROFILEif (!(Test-Path -Path $PROFILE )) &#123; New-Item -Type File -Path $PROFILE -Force &#125;notepad $PROFILE#在打开的文件中输入Import-Module posh-gitImport-Module oh-my-poshSet-Theme Honukai\nWSL2dism.exe /online /enable-feature /featurename:Microsoft-Windows-Subsystem-Linux /all /norestartdism.exe /online /enable-feature /featurename:VirtualMachinePlatform /all /norestartwsl --set-default-version 2\n","categories":["linux"],"tags":["scoop","wsl"]},{"title":"scoop","url":"/2024/08/06/scoop/","content":"Windows 下的一些配置，包括powershell，scoop，wsl2等。\n\n\nwindows安装powershell7选择win-x64-msi安装or\nwinget search Microsoft.PowerShellwinget install --id Microsoft.PowerShell --source winget\n\ninstall scoopSet-ExecutionPolicy -ExecutionPolicy RemoteSigned -Scope CurrentUserInvoke-RestMethod -Uri https://get.scoop.sh | Invoke-Expression\n\n关于scoopscoop是windows上的一个强大的包管理，可惜默认的软件仓库(main bucket)数量有限，因此我们需要添加额外的软件仓库：\n# list support bucket❯ scoop bucket knownmainextrasversionsnirsoftsysinternalsphpnerd-fontsnonportablejavagames# list bucket local❯ scoop bucket listName   Source                                    Updated           Manifests----   ------                                    -------           ---------main   https://github.com/ScoopInstaller/Main    2024/8/6 12:29:26      1337extras https://gitee.com/scoop-bucket/extras.git 2024/8/6 8:35:51       2053\n\n一般来说只需要一个main和extras就够了\nscoop bucket add extras\n\n在scoop安装的过程中可能需要配置scoop的安装路径，但是我建议是都安装c盘，因为安装的基本都是常用而且比较小的，如编译器，rust构建的系统工具等等\nscoop 常用命令scoop update * #更新所有包scoop config proxy 127.0.0.1:7890 #设置代理scoop uninstall appnamescoop search appnamescoop install appnamescoop reset appname/* #恢复app或者所有app\n\n下面是一些常用软件，包括编译器，rust小工具以及一些系统级工具(无需mingw和msys2，直接就能安装gcc和llvm，不花里胡哨)\nscoop listInstalled apps:Name          Version                  Source Updated             Info----          -------                  ------ -------             ----7zip          24.07                    main   2024-06-20 21:02:13bat           0.24.0                   main   2023-11-29 20:48:29bottom        0.10.2                   main   2024-08-06 15:21:29broot         1.41.1                   main   2024-08-05 10:24:13cacert        2024-07-02               main   2024-07-03 10:43:22cmake         3.30.2                   main   2024-08-04 12:29:32curl          8.9.1_1                  main   2024-08-04 12:29:37dark          3.14                     main   2024-07-19 13:40:25delta         0.17.0                   main   2024-03-18 14:19:35duf           0.8.1                    main   2023-12-09 16:24:31dust          1.1.1                    main   2024-07-18 11:34:03eza           0.18.24                  main   2024-08-04 12:29:42fastfetch     2.21.0                   main   2024-08-05 16:54:07fd            10.1.0                   main   2024-05-10 10:55:01file          5.45                     main   2023-12-28 11:53:11fzf           0.54.3                   main   2024-08-04 12:29:48gcc           13.2.0                   main   2024-08-05 22:11:32gdu           5.29.0                   main   2024-07-16 15:09:31git           2.46.0                   main   2024-07-30 17:48:02glow          1.5.1                    main   2024-06-22 13:37:17go            1.22.5                   main   2024-07-03 10:44:28grex          1.4.5                    main   2024-03-09 13:16:11gsudo         2.5.1                    main   2024-05-31 15:47:23helix         24.07                    main   2024-07-15 11:32:41hyperfine     1.18.0                   main   2023-12-09 17:08:18imagemagick   7.1.1-36                 main   2024-08-02 10:41:01innounp       0.50                     main   2024-06-16 18:35:29jq            1.7.1                    main   2023-12-27 16:15:36keyviz        1.0.6                    extras 2024-06-16 18:35:35lazygit       0.43.1                   extras 2024-07-14 12:15:12less          661                      main   2024-07-01 20:00:40llvm          18.1.8                   main   2024-08-05 22:12:57lua           5.4.7-2                  main   2024-07-27 11:33:03luarocks      3.11.1                   main   2024-07-16 01:04:19make          4.4.1                    main   2023-11-29 21:01:44miller        6.12.0                   main   2024-06-22 13:41:01miniconda3    24.5.0-0                 extras 2024-07-19 13:49:32mpv           0.38.0                   extras 2024-06-19 21:20:39neovide       0.13.3                   extras 2024-07-18 11:34:07neovim        0.10.1                   main   2024-07-27 12:15:40ninja         1.12.1                   main   2024-05-18 13:33:50nodejs        22.5.1                   main   2024-07-21 17:02:34onefetch      2.21.0                   extras 2024-06-27 16:02:02ouch          0.5.1                    main   2024-06-22 13:43:50poppler       24.07.0-0                main   2024-07-27 22:41:12procs         0.14.6                   main   2024-07-30 17:51:00ripgrep       14.1.0                   main   2024-01-09 20:52:55ruby          3.3.4-1                  main   2024-07-12 11:28:59rust-analyzer 2024-08-05               main   2024-08-05 16:54:10scoop-search  1.5.0                    main   2024-07-10 10:40:35sd            1.0.0                    main   2023-12-09 16:55:11starship      1.20.1                   main   2024-07-27 22:42:34tealdeer      1.6.1                    main   2023-12-09 16:26:07tokei         12.1.2                   main   2023-11-29 20:46:57tree-sitter   0.22.6                   main   2024-05-10 10:55:49unar          1.8.1                    main   2023-12-27 16:15:44wezterm       20240203-110809-5046fc22 extras 2024-03-06 17:29:06wget          1.21.4                   main   2023-11-29 22:29:31which         2.20                     main   2023-12-02 14:27:18whkd          0.2.1                    extras 2024-04-11 16:23:03yarn          1.22.22                  main   2024-05-25 22:07:31zoxide        0.9.4                    main   2024-02-22 12:17:08\n\n安装 weztermwezterm是一个强大的跨平台终端模拟器，采用rust编写，在这个赛道有多个竞品，如alacritty，windows terminal，其中WT是json格式的config，alacritty作者摆烂，相比之下wezterm的作者就很勤快了，更重要的一个原因，wezterm是目前少数可以绕过windows下的ConPTY的terminal，它采用ssh的特性，使得wsl内可以实现很多原生linux才有的功能。\nscoop install wezterm\n\n配置文件参考wezterm，位于~&#x2F;.config&#x2F;wezterm\npowershell 配置在使用下面的配置文件之前，至少准备这些软件，都可以通过scoop安装：\n\nstarship # rust 构建的shell外观美化\nyazi # rust 构建的终端文件管理器\nexa # rust 构建的系统工具，代替ls命令\nzoxide # rust 构建的系统工具，代替cd命令\n\n也可以注释掉相应的部分来避免下载这些软件，接着打开powershell配置文件：notepad $PROFILE\nImport-Module PSReadLineInvoke-Expression (&amp;starship init powershell)Import-Module -Name Terminal-IconsSet-PSReadLineOption -EditMode EmacsSet-PSReadLineOption -PredictionSource HistoryAndPluginSet-PSReadLineOption -HistorySearchCursorMovesToEndSet-PSReadLineOption -HistorySaveStyle SaveIncrementallySet-PSReadLineOption -PredictionViewStyle ListViewSet-PSReadLineOption -PredictionSource HistorySet-PSReadLineOption -BellStyle NoneSet-PSReadLineKeyHandler -Key &#x27;Tab&#x27; -Function MenuCompleteSet-PSReadLineKeyHandler -Key &#x27;Ctrl+z&#x27; -Function undo# Set-PSReadLineKeyHandler -Key &#x27;Tab&#x27; -Function CompleteSet-PSReadLineKeyHandler -Key &#x27;Ctrl+k&#x27; -Function HistorySearchBackwardSet-PSReadLineKeyHandler -Key &#x27;Ctrl+j&#x27; -Function HistorySearchForward## open current folderfunction OpenCurrentFolder &#123;param ($Path = &#x27;.&#x27;)Invoke-Item $Path&#125;## yazifunction yy &#123;$tmp = [System.IO.Path]::GetTempFileName()    yazi $args --cwd-file=&quot;$tmp&quot;$cwd = Get-Content -Path $tmp    if (-not [String]::IsNullOrEmpty($cwd) -and $cwd -ne $PWD.Path) &#123;Set-Location -LiteralPath $cwd&#125;Remove-Item -Path $tmp&#125;## k is a function to kill a process by its IDfunction k &#123;Stop-Process -Id $args&#125;## exa replace lsfunction ls &#123;exa --icons --group-directories-first --color-scale --color=always --git --long --all --header --time-style=long-iso --group --classify $args&#125;function l &#123;exa -lbah @args&#125;function ll &#123;exa -lbg @args&#125;function la &#123;exa -lbahg @args&#125;## Set-AliasSet-Alias -Name vi -Value nvimSet-Alias -Name br -Value brootSet-Alias -Name open -Value OpenCurrentFolderSet-Alias -Name nide -Value neovideInvoke-Expression (&amp; &#123; (zoxide init powershell | Out-String) &#125;)\nWSL2 CUDAwsl2的安装不作介绍，两个概念：nvidia-smi是驱动,是nvidia显卡正常使用所必须的环境，nvcc是runtime，用于编译cpp和cu代码，NVIDIA官方建议在wsl2中无需安装任何cuda驱动，因为windows内安装完驱动之后，wsl内能自动识别到驱动：\nwhich nvidia-smi/usr/lib/wsl/lib/nvidia-smi\n要在wsl内安装nvcc，则需要单独安装cuda-toolkit，但是一些linux发行版默认的包管理器安装cuda，会包含驱动，为了避免驱动覆盖，我们只需要单独安装cuda-toolkit，幸运的是，archlinux的pacman内的两个package均不含驱动，直接安装即可，如果是其他发行版，移步NVIDIA，选择特定的版本安装。\nsudo pacman -S cuda cuda-toolssudo pacman -Ss cudaextra/cuda 12.5.1-1 [installed]NVIDIA&#x27;s GPU programming toolkitextra/cuda-tools 12.5.1-1 [installed]NVIDIA&#x27;s GPU programming toolkit (extra tools: nvvp, nsight)\n该安装可能会额外下载一个gcc-13或者其他版本，因为nvcc也对gcc版本有要求，这时候如果我们默认的gcc版本不兼容，我们需要指定环境变量cuda_host_CXX：\n# nvidia hpc-sdk 用来编译fortran, 需要单独下载，搜索hpc-sdkexport NVARCH=`uname -s`_`uname -m`export NVCOMPILERS=/opt/nvidia/hpc_sdkexport MANPATH=$MANPATH:$NVCOMPILERS/$NVARCH/24.7/compilers/manexport PATH=$NVCOMPILERS/$NVARCH/24.7/compilers/bin:$PATHexport PATH=$NVCOMPILERS/$NVARCH/24.7/comm_libs/mpi/bin:$PATHexport MANPATH=$MANPATH:$NVCOMPILERS/$NVARCH/24.7/comm_libs/mpi/manexport MODULEPATH=$NVCOMPILERS/modulefiles:$MODULEPATH## cudaexport CUDADIR=/opt/cudaexport PATH=$CUDADIR/bin:$PATHexport LD_LIBRARY_PATH=$&#123;LD_LIBRARY_PATH:+$LD_LIBRARY_PATH:&#125;$CUDADIR/libexport CPLUS_INCLUDE_PATH=$CUDADIR/include:$CPLUS_INCLUDE_PATHexport CUDA_HOME=/opt/cuda## cuda_host_CXXexport NVCC-CCBIN=/usr/bin/g++-13\n\n以上hpc-sdk和cuda都内置了nvcc，且版本一致，那为什么要下载两个呢？首先nvcc虽然看上去是一个cuda编译器，但是它实际上是一个驱动，用于调用g++编译cpp代码并且和cu代码链接起来，形成最终的可执行程序。它本身并不编译cpp，并且cuda toolkit内置了一系列cuda库，包括cuBLAS，cuFFT，cuDNN，TensorRT，一系列调试和性能分析工具，多用于机器学习，数据分析和科学计算中，而hpc-sdk是包含了CUDA的部分componet以及一系列编译器，nvfortran(没错，我就是为了这个下载的，并且hpc-sdk不支持windows)，nvc，nvc++，这个nvc++就可以直接编译cu文件。hpc-sdk内置的编译器：\n❯ which nvcc                          /opt/nvidia/hpc_sdk/Linux_x86_64/24.7/compilers/bin/nvcc❯ nvc -V                              nvc 24.7-0 64-bit target on x86-64 Linux -tp alderlake NVIDIA Compilers and ToolsCopyright (c) 2024, NVIDIA CORPORATION &amp; AFFILIATES.  All rights reserved.❯ nvc++ -Vnvc++ 24.7-0 64-bit target on x86-64 Linux -tp alderlake NVIDIA Compilers and ToolsCopyright (c) 2024, NVIDIA CORPORATION &amp; AFFILIATES.  All rights reserved.❯ nvcc -V                   nvcc: NVIDIA (R) Cuda compiler driverCopyright (c) 2005-2024 NVIDIA CorporationBuilt on Thu_Jun__6_02:18:23_PDT_2024Cuda compilation tools, release 12.5, V12.5.82Build cuda_12.5.r12.5/compiler.34385749_0❯ nvfortran -V                         nvfortran 24.7-0 64-bit target on x86-64 Linux -tp alderlake NVIDIA Compilers and ToolsCopyright (c) 2024, NVIDIA CORPORATION &amp; AFFILIATES.  All rights reserved.\n看上去hpc-sdk的编译器(nvcc,nvc,nvc++,nvfortran)比cuda的编译器(nvcc)完整，但是cuda的头文件比hpc-sdk内置cuda头文件更完整：\n## 在cuda和hpc-sdk的安装目录下，我们分别查看头文件库，可以发现数量是不一致的，比如curand.h这个头文件hpc-sdk就没有:❯ pwd/opt/cuda/include❯ ls | wc -l156❯ ls | rg curcurand.hcurand_discrete.hcurand_discrete2.hcurand_globals.hcurand_kernel.hcurand_lognormal.hcurand_mrg32k3a.hcurand_mtgp32.hcurand_mtgp32_host.hcurand_mtgp32_kernel.hcurand_mtgp32dc_p_11213.hcurand_normal.hcurand_normal_static.hcurand_philox4x32_x.hcurand_poisson.hcurand_precalc.hcurand_uniform.h❯ pwd/opt/nvidia/hpc_sdk/Linux_x86_64/2024/cuda/include❯ ls | wc -l 119❯ ls | rg cur\n所以一般来说只需要下载cuda就够了(除非需要用到特定的编译器)，上面hpc-sdk的部分可以先注释掉\n测试代码首先是CMakeLists:\ncmake_minimum_required(VERSION 3.28)set(CMAKE_CUDA_ARCHITECTURES &quot;native&quot;)project(test CUDA)set(CMAKE_CUDA_STANDARD 20)add_executable(test main.cu)set_target_properties(test PROPERTIES CUDA_SEPARABLE_COMPILATION ON)\nmain.cu:\n#include &lt;cuda_runtime.h&gt;#include &lt;stdio.h&gt;__global__ void cuda_hello() &#123; printf(&quot;hello world from GPU!\\n&quot;); &#125;auto main() -&gt; int&#123;    cuda_hello&lt;&lt;&lt;1, 10&gt;&gt;&gt;();    cudaDeviceReset();    return 0;&#125;\n首先，如果没有环境变量NVCC-CCBIN&#x3D;&#x2F;usr&#x2F;bin&#x2F;g++-13，直接使用nvcc编译，你可能会得到错误:\n❯ nvcc main.cu In file included from /opt/nvidia/hpc_sdk/Linux_x86_64/24.7/cuda/12.5/include/cuda_runtime.h:82,                 from &lt;command-line&gt;:/opt/nvidia/hpc_sdk/Linux_x86_64/24.7/cuda/12.5/include/crt/host_config.h:143:2: error: #error -- unsupported GNU version! gcc versions later than 13 are not supported! The nvcc flag &#x27;-allow-unsupported-compiler&#x27; can be used to override this version check; however, using an unsupported host compiler may cause compilation failure or incorrect run time execution. Use at your own risk.  143 | #error -- unsupported GNU version! gcc versions later than 13 are not supported! The nvcc flag &#x27;-allow-unsupported-compiler&#x27; can be used to override this version check; however, using an unsupported host compiler may cause compilation failure or incorrect run time execution. Use at your own risk.\n大概意思就是gcc版本不对，此时我们加上参数-ccbin gcc-13，这个gcc-13是下载cuda时自带的:\n nvcc -ccbin gcc-13 main.cu ./a.outhello world from GPU!hello world from GPU!hello world from GPU!hello world from GPU!hello world from GPU!hello world from GPU!hello world from GPU!hello world from GPU!hello world from GPU!hello world from GPU!\n也可以直接用nvc++编译(如果下载的有hpc-sdk的话)：\n❯ nvc++ main.cu❯ ./a.outhello world from GPU!hello world from GPU!hello world from GPU!hello world from GPU!hello world from GPU!hello world from GPU!hello world from GPU!hello world from GPU!hello world from GPU!hello world from GPU!\n如果在.cu的程序内包含了c++的标准库(比如各种STL)，需要指定c++链接库，因为nvcc并不处理c++的依赖：\n#include &lt;cuda_runtime.h&gt;#include &lt;stdio.h&gt;#include &lt;iostream&gt;__global__ void cuda_hello() &#123; printf(&quot;hello world from GPU!\\n&quot;); &#125;auto main() -&gt; int&#123;    cuda_hello&lt;&lt;&lt;1, 10&gt;&gt;&gt;();    cudaDeviceReset();    std::cout &lt;&lt; &quot;Hello world from CPU use STL!&quot; &lt;&lt; std::endl;    return 0;&#125;\n此时继续编译会报错：\n❯ nvcc -ccbin gcc-13 main.cu/usr/sbin/ld: /tmp/tmpxft_0001c412_00000000-11_main.o: warning: relocation against `_ZSt4cout&#x27; in read-only section `.text&#x27;/usr/sbin/ld: /tmp/tmpxft_0001c412_00000000-11_main.o: in function `main&#x27;:tmpxft_0001c412_00000000-6_main.cudafe1.cpp:(.text+0xa6): undefined reference to `std::cout&#x27;/usr/sbin/ld: tmpxft_0001c412_00000000-6_main.cudafe1.cpp:(.text+0xae): undefined reference to `std::basic_ostream&lt;char, std::char_traits&lt;char&gt; &gt;&amp; std::operator&lt;&lt; &lt;std::char_traits&lt;char&gt; &gt;(std::basic_ostream&lt;char, std::char_traits&lt;char&gt; &gt;&amp;, char const*)&#x27;/usr/sbin/ld: tmpxft_0001c412_00000000-6_main.cudafe1.cpp:(.text+0xb5): undefined reference to `std::basic_ostream&lt;char, std::char_traits&lt;char&gt; &gt;&amp; std::endl&lt;char, std::char_traits&lt;char&gt; &gt;(std::basic_ostream&lt;char, std::char_traits&lt;char&gt; &gt;&amp;)&#x27;/usr/sbin/ld: tmpxft_0001c412_00000000-6_main.cudafe1.cpp:(.text+0xc0): undefined reference to `std::ostream::operator&lt;&lt;(std::ostream&amp; (*)(std::ostream&amp;))&#x27;/usr/sbin/ld: warning: creating DT_TEXTREL in a PIEcollect2: error: ld returned 1 exit status\n加上-lstdc++命令之后成功：\n❯ nvcc -ccbin gcc-13 main.cu -lstdc++❯ ./a.outhello world from GPU!hello world from GPU!hello world from GPU!hello world from GPU!hello world from GPU!hello world from GPU!hello world from GPU!hello world from GPU!hello world from GPU!hello world from GPU!Hello world from CPU use STL!\n所以最好用NVCC-CCBIN环境变量来指定host端的c++compiler，这样直接使用nvcc编译，也会自动链接到对应的库如果使用cmake编译：\n cmake .. &amp;&amp; make -j-- The CUDA compiler identification is NVIDIA 12.5.82-- Detecting CUDA compiler ABI info-- Detecting CUDA compiler ABI info - done-- Check for working CUDA compiler: /opt/cuda/bin/nvcc - skipped-- Detecting CUDA compile features-- Detecting CUDA compile features - done-- Configuring done (3.7s)-- Generating done (0.0s)-- Build files have been written to: /home/mafu/Documents/cuda/0/build[ 33%] Building CUDA object CMakeFiles/test.dir/main.cu.o[ 66%] Linking CUDA device code CMakeFiles/test.dir/cmake_device_link.o[100%] Linking CUDA executable test[100%] Built target test ./testhello world from GPU!hello world from GPU!hello world from GPU!hello world from GPU!hello world from GPU!hello world from GPU!hello world from GPU!hello world from GPU!hello world from GPU!hello world from GPU!\n（同样，如果包含c++标准库请在CMakelists.txt末尾添加: target_link_libraries(test stdc++)但是假如我们把NVCC-CCBIN变量从zshrc内移除：\n echo $NVCC-CCBIN (无输出) cmake .. &amp;&amp; make -jCMake Error at /usr/share/cmake/Modules/CMakeDetermineCompilerId.cmake:838 (message):  Compiling the CUDA compiler identification source file  &quot;CMakeCUDACompilerId.cu&quot; failed.  Compiler: /opt/cuda/bin/nvcc  Build flags:  Id flags: --keep;--keep-dir;tmp -v\n一大堆看不懂的错误，此时要想正常编译，需要以下参数指定版本:\ncmake -DCMAKE_CUDA_FLAGS=&quot;-ccbin /usr/bin/gcc-13&quot; ..\n总而言之，cmake貌似默认使用nvcc作为编译器，wsl下要想编译cu代码，请使用以下命令:\nnvcc -ccbin gcc-13 main.cu -lstdc++nvcc main.cu #(指定NVCC-CCBIN)# ornvc++ main.cu# or cmake (with export NVCC-CCBIN=/usr/bin/g++-13)cmake .. &amp;&amp; make# or without NVCC-CCBINcmake -DCMAKE_CUDA_FLAGS=&quot;-ccbin /usr/bin/gcc-13&quot; ..# 即注意nvcc支持的gcc版本以及c++标准库\n测试代码2（c++和cuda混合编译）CMakeLists\ncmake_minimum_required(VERSION 3.28)set(CMAKE_CUDA_ARCHITECTURES &quot;native&quot;)project(cuda_project CUDA CXX)set(CMAKE_CUDA_STANDARD 17)add_executable(cuda_project main.cpp kernel1.cu kernel2.cu)set_target_properties(cuda_project PROPERTIES CUDA_SEPARABLE_COMPILATION ON)\nmain.cpp\n#include &lt;iostream&gt;void kernel1();void kernel2();auto main() -&gt; int&#123;    std::cout &lt;&lt; &quot;Calling kernel1&quot; &lt;&lt; std::endl;    kernel1();    std::cout &lt;&lt; &quot;Calling kernel2&quot; &lt;&lt; std::endl;    kernel2();    return 0;&#125;\nkernel1\n#include &lt;stdio.h&gt;__global__ void kernel1_func() &#123; printf(&quot;Hello from kernel1\\n&quot;); &#125;void kernel1()&#123;    kernel1_func&lt;&lt;&lt;1, 1&gt;&gt;&gt;();    cudaDeviceSynchronize();&#125;\nkernel2\n#include &lt;stdio.h&gt;__global__ void kernel2_func() &#123; printf(&quot;Hello from kernel2\\n&quot;); &#125;void kernel2()&#123;    kernel2_func&lt;&lt;&lt;1, 1&gt;&gt;&gt;();    cudaDeviceSynchronize();&#125;\n编译\n❯ cmake .. &amp;&amp; make -j-- The CUDA compiler identification is NVIDIA 12.5.82-- The CXX compiler identification is GNU 14.2.1-- Detecting CUDA compiler ABI info-- Detecting CUDA compiler ABI info - done-- Check for working CUDA compiler: /opt/cuda/bin/nvcc - skipped-- Detecting CUDA compile features-- Detecting CUDA compile features - done-- Detecting CXX compiler ABI info-- Detecting CXX compiler ABI info - done-- Check for working CXX compiler: /usr/sbin/c++ - skipped-- Detecting CXX compile features-- Detecting CXX compile features - done-- Configuring done (4.7s)-- Generating done (0.0s)-- Build files have been written to: /home/mafu/Documents/cuda/test/build[ 40%] Building CUDA object CMakeFiles/cuda_project.dir/kernel1.cu.o[ 40%] Building CXX object CMakeFiles/cuda_project.dir/main.cpp.o[ 60%] Building CUDA object CMakeFiles/cuda_project.dir/kernel2.cu.o[ 80%] Linking CUDA device code CMakeFiles/cuda_project.dir/cmake_device_link.o[100%] Linking CXX executable cuda_project[100%] Built target cuda_project❯ ./cuda_projectCalling kernel1Hello from kernel1Calling kernel2Hello from kernel2\n另外，可能你已经发现了cmake的输出信息，显示识别到CXX编译器版本是GNU 14.2.1，并不是gcc-13，这是为什么呢？因为我们的环境变量里指定了export NVCC-CCBIN&#x3D;&#x2F;usr&#x2F;bin&#x2F;g++-13，虽然识别到gcc14，但是编译还是使用的gcc13，不信可以将这个变量取消验证，cmake会报错的，提示没有set cxx编译器。\n","tags":["windows","wsl2"]}]